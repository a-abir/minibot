

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>matplotlib.figure &mdash; deflection 0.01a documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> deflection
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../deflection.html">Code Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howtouse.html">How to use the app</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">deflection</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>matplotlib.figure</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for matplotlib.figure</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The figure module provides the top-level</span>
<span class="sd">:class:`~matplotlib.artist.Artist`, the :class:`Figure`, which</span>
<span class="sd">contains all the plot elements.  The following classes are defined</span>

<span class="sd">:class:`SubplotParams`</span>
<span class="sd">    control the default spacing of the subplots</span>

<span class="sd">:class:`Figure`</span>
<span class="sd">    Top level container for all plot elements.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">numbers</span> <span class="k">import</span> <span class="n">Integral</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">rcParams</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">backends</span><span class="p">,</span> <span class="n">docstring</span><span class="p">,</span> <span class="n">projections</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">_mpl_version</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">get_backend</span>

<span class="kn">import</span> <span class="nn">matplotlib.artist</span> <span class="k">as</span> <span class="nn">martist</span>
<span class="kn">from</span> <span class="nn">matplotlib.artist</span> <span class="k">import</span> <span class="n">Artist</span><span class="p">,</span> <span class="n">allow_rasterization</span>
<span class="kn">from</span> <span class="nn">matplotlib.backend_bases</span> <span class="k">import</span> <span class="n">FigureCanvasBase</span>
<span class="kn">import</span> <span class="nn">matplotlib.cbook</span> <span class="k">as</span> <span class="nn">cbook</span>
<span class="kn">import</span> <span class="nn">matplotlib.colorbar</span> <span class="k">as</span> <span class="nn">cbar</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="k">as</span> <span class="nn">mimage</span>

<span class="kn">from</span> <span class="nn">matplotlib.axes</span> <span class="k">import</span> <span class="n">Axes</span><span class="p">,</span> <span class="n">SubplotBase</span><span class="p">,</span> <span class="n">subplot_class_factory</span>
<span class="kn">from</span> <span class="nn">matplotlib.blocking_input</span> <span class="k">import</span> <span class="n">BlockingMouseInput</span><span class="p">,</span> <span class="n">BlockingKeyMouseInput</span>
<span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="k">import</span> <span class="n">GridSpec</span>
<span class="kn">import</span> <span class="nn">matplotlib.legend</span> <span class="k">as</span> <span class="nn">mlegend</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="k">import</span> <span class="n">Rectangle</span>
<span class="kn">from</span> <span class="nn">matplotlib.projections</span> <span class="k">import</span> <span class="p">(</span><span class="n">get_projection_names</span><span class="p">,</span>
                                    <span class="n">process_projection_requirements</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib.text</span> <span class="k">import</span> <span class="n">Text</span><span class="p">,</span> <span class="n">TextWithDash</span>
<span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="k">import</span> <span class="p">(</span><span class="n">Affine2D</span><span class="p">,</span> <span class="n">Bbox</span><span class="p">,</span> <span class="n">BboxTransformTo</span><span class="p">,</span>
                                   <span class="n">TransformedBbox</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib._layoutbox</span> <span class="k">as</span> <span class="nn">layoutbox</span>
<span class="kn">from</span> <span class="nn">matplotlib.backend_bases</span> <span class="k">import</span> <span class="n">NonGuiException</span>

<span class="n">_log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">docstring</span><span class="o">.</span><span class="n">interpd</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">projection_names</span><span class="o">=</span><span class="n">get_projection_names</span><span class="p">())</span>


<span class="k">def</span> <span class="nf">_stale_figure_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="n">val</span>


<span class="k">class</span> <span class="nc">AxesStack</span><span class="p">(</span><span class="n">cbook</span><span class="o">.</span><span class="n">Stack</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of the `.Stack` to handle all tracking of</span>
<span class="sd">    `~matplotlib.axes.Axes` in a `.Figure`.</span>
<span class="sd">    This stack stores ``key, (ind, axes)`` pairs, where:</span>

<span class="sd">        * **key** should be a hash of the args and kwargs</span>
<span class="sd">          used in generating the Axes.</span>
<span class="sd">        * **ind** is a serial number for tracking the order</span>
<span class="sd">          in which axes were added.</span>

<span class="sd">    The AxesStack is a callable, where ``ax_stack()`` returns</span>
<span class="sd">    the current axes. Alternatively the :meth:`current_key_axes` will</span>
<span class="sd">    return the current key and associated axes.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ind</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">as_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of the Axes instances that have been added to the figure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ia_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="p">]</span>
        <span class="n">ia_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ia_list</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the Axes instance that was added with *key*.</span>
<span class="sd">        If it is not present, return *None*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">item</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">cbook</span><span class="o">.</span><span class="n">warn_deprecated</span><span class="p">(</span>
            <span class="s2">&quot;2.1&quot;</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Adding an axes using the same arguments as a previous &quot;</span>
            <span class="s2">&quot;axes currently reuses the earlier instance.  In a future &quot;</span>
            <span class="s2">&quot;version, a new instance will always be created and returned.  &quot;</span>
            <span class="s2">&quot;Meanwhile, this warning can be suppressed, and the future &quot;</span>
            <span class="s2">&quot;behavior ensured, by passing a unique label to each axes &quot;</span>
            <span class="s2">&quot;instance.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_entry_from_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="n">ind</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="p">}[</span><span class="n">e</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove the axes from the stack.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_entry_from_axes</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">bubble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Move the given axes, which must already exist in the</span>
<span class="sd">        stack, to the top.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bubble</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_entry_from_axes</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add Axes *a*, with key *key*, to the stack, and return the stack.</span>

<span class="sd">        If *key* is unhashable, replace it by a unique, arbitrary object.</span>

<span class="sd">        If *a* is already on the stack, don&#39;t add it again, but</span>
<span class="sd">        return *None*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># All the error checking may be unnecessary; but this method</span>
        <span class="c1"># is called so seldom that the overhead is negligible.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Axes</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;second argument, </span><span class="si">{!r}</span><span class="s2">, is not an Axes&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">hash</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>

        <span class="n">a_existing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a_existing</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="n">a_existing</span><span class="p">))</span>
            <span class="n">cbook</span><span class="o">.</span><span class="n">_warn_external</span><span class="p">(</span>
                <span class="s2">&quot;key </span><span class="si">{!r}</span><span class="s2"> already existed; Axes is being replaced&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
            <span class="c1"># I don&#39;t think the above should ever happen.</span>

        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ind</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">push</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ind</span><span class="p">,</span> <span class="n">a</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">current_key_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a tuple of ``(key, axes)`` for the active axes.</span>

<span class="sd">        If no axes exists on the stack, then returns ``(None, None)``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">key</span><span class="p">,</span> <span class="n">axes</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_key_axes</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_list</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">SubplotParams</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to hold the parameters for a subplot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">wspace</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        All dimensions are fractions of the figure width or height.</span>
<span class="sd">        Defaults are given by :rc:`figure.subplot.[name]`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        left : float</span>
<span class="sd">            The left side of the subplots of the figure.</span>

<span class="sd">        right : float</span>
<span class="sd">            The right side of the subplots of the figure.</span>

<span class="sd">        bottom : float</span>
<span class="sd">            The bottom of the subplots of the figure.</span>

<span class="sd">        top : float</span>
<span class="sd">            The top of the subplots of the figure.</span>

<span class="sd">        wspace : float</span>
<span class="sd">            The amount of width reserved for space between subplots,</span>
<span class="sd">            expressed as a fraction of the average axis width.</span>

<span class="sd">        hspace : float</span>
<span class="sd">            The amount of height reserved for space between subplots,</span>
<span class="sd">            expressed as a fraction of the average axis height.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">wspace</span><span class="p">,</span> <span class="n">hspace</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">wspace</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the dimensions of the passed parameters. *None* means unchanged.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">thisleft</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">thisright</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">thistop</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">thisbottom</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">thiswspace</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;wspace&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">thishspace</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;hspace&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_this</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">left</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_this</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_this</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_this</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">top</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_this</span><span class="p">(</span><span class="s1">&#39;wspace&#39;</span><span class="p">,</span> <span class="n">wspace</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_this</span><span class="p">(</span><span class="s1">&#39;hspace&#39;</span><span class="p">,</span> <span class="n">hspace</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">reset</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">thisleft</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">thisright</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">thistop</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">thisbottom</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wspace</span> <span class="o">=</span> <span class="n">thiswspace</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hspace</span> <span class="o">=</span> <span class="n">thishspace</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">:</span>
                <span class="n">reset</span><span class="p">()</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;left cannot be &gt;= right&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">:</span>
                <span class="n">reset</span><span class="p">()</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;bottom cannot be &gt;= top&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_this</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;figure.subplot.&#39;</span> <span class="o">+</span> <span class="n">s</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Figure</span><span class="p">(</span><span class="n">Artist</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The top level container for all the plot elements.</span>

<span class="sd">    The Figure instance supports callbacks through a *callbacks* attribute</span>
<span class="sd">    which is a `.CallbackRegistry` instance.  The events you can connect to</span>
<span class="sd">    are &#39;dpi_changed&#39;, and the callback will be called with ``func(fig)`` where</span>
<span class="sd">    fig is the `Figure` instance.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    patch</span>
<span class="sd">        The `.Rectangle` instance representing the figure background patch.</span>

<span class="sd">    suppressComposite</span>
<span class="sd">        For multiple figure images, the figure will make composite images</span>
<span class="sd">        depending on the renderer option_image_nocomposite function.  If</span>
<span class="sd">        *suppressComposite* is a boolean, this will override the renderer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Figure(</span><span class="si">%g</span><span class="s2">x</span><span class="si">%g</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&lt;</span><span class="si">{clsname}</span><span class="s2"> size </span><span class="si">{h:g}</span><span class="s2">x</span><span class="si">{w:g}</span><span class="s2"> with </span><span class="si">{naxes}</span><span class="s2"> Axes&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">clsname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="n">h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">naxes</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">facecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                 <span class="n">frameon</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">subplotpars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># default to rc</span>
                 <span class="n">tight_layout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># default to rc figure.autolayout</span>
                 <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># default to rc</span>
                                          <span class="c1">#figure.constrained_layout.use</span>
                 <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        figsize : 2-tuple of floats, default: :rc:`figure.figsize`</span>
<span class="sd">            Figure dimension ``(width, height)`` in inches.</span>

<span class="sd">        dpi : float, default: :rc:`figure.dpi`</span>
<span class="sd">            Dots per inch.</span>

<span class="sd">        facecolor : default: :rc:`figure.facecolor`</span>
<span class="sd">            The figure patch facecolor.</span>

<span class="sd">        edgecolor : default: :rc:`figure.edgecolor`</span>
<span class="sd">            The figure patch edge color.</span>

<span class="sd">        linewidth : float</span>
<span class="sd">            The linewidth of the frame (i.e. the edge linewidth of the figure</span>
<span class="sd">            patch).</span>

<span class="sd">        frameon : bool, default: :rc:`figure.frameon`</span>
<span class="sd">            If ``False``, suppress drawing the figure background patch.</span>

<span class="sd">        subplotpars : :class:`SubplotParams`</span>
<span class="sd">            Subplot parameters. If not given, the default subplot</span>
<span class="sd">            parameters :rc:`figure.subplot.*` are used.</span>

<span class="sd">        tight_layout : bool or dict, default: :rc:`figure.autolayout`</span>
<span class="sd">            If ``False`` use *subplotpars*. If ``True`` adjust subplot</span>
<span class="sd">            parameters using `.tight_layout` with default padding.</span>
<span class="sd">            When providing a dict containing the keys ``pad``, ``w_pad``,</span>
<span class="sd">            ``h_pad``, and ``rect``, the default `.tight_layout` paddings</span>
<span class="sd">            will be overridden.</span>

<span class="sd">        constrained_layout : bool</span>
<span class="sd">            If ``True`` use constrained layout to adjust positioning of plot</span>
<span class="sd">            elements.  Like ``tight_layout``, but designed to be more</span>
<span class="sd">            flexible.  See</span>
<span class="sd">            :doc:`/tutorials/intermediate/constrainedlayout_guide`</span>
<span class="sd">            for examples.  (Note: does not work with :meth:`.subplot` or</span>
<span class="sd">            :meth:`.subplot2grid`.)</span>
<span class="sd">            Defaults to :rc:`figure.constrained_layout.use`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># remove the non-figure artist _axes property</span>
        <span class="c1"># as it makes no sense for a figure to be _in_ an axes</span>
        <span class="c1"># this is used by the property methods in the artist base class</span>
        <span class="c1"># which are over-ridden in this class</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">CallbackRegistry</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">dpi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dpi</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">facecolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">facecolor</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.facecolor&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">edgecolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">edgecolor</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.edgecolor&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">frameon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">frameon</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.frameon&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">figsize</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;figure size must be finite not &#39;</span>
                             <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">figsize</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_inches</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">figsize</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dpi_scale_trans</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">dpi</span><span class="p">,</span> <span class="n">dpi</span><span class="p">)</span>
        <span class="c1"># do not use property as it will trigger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dpi</span> <span class="o">=</span> <span class="n">dpi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span> <span class="o">=</span> <span class="n">TransformedBbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_inches</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi_scale_trans</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">transFigure</span> <span class="o">=</span> <span class="n">BboxTransformTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="n">visible</span><span class="o">=</span><span class="n">frameon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_artist_props</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_antialiased</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">FigureCanvasBase</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># Set self.canvas.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">subplotpars</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subplotpars</span> <span class="o">=</span> <span class="n">SubplotParams</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">subplotpars</span> <span class="o">=</span> <span class="n">subplotpars</span>
        <span class="c1"># constrained_layout:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_layoutbox</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># set in set_constrained_layout_pads()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_constrained_layout</span><span class="p">(</span><span class="n">constrained_layout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_tight_layout</span><span class="p">(</span><span class="n">tight_layout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span> <span class="o">=</span> <span class="n">AxesStack</span><span class="p">()</span>  <span class="c1"># track all figure axes and current axes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cachedRenderer</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># groupers to keep track of x and y labels we want to align.</span>
        <span class="c1"># see self.align_xlabels and self.align_ylabels and</span>
        <span class="c1"># axis._get_tick_boxes_siblings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_align_xlabel_grp</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">Grouper</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_align_ylabel_grp</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">Grouper</span><span class="p">()</span>

        <span class="c1"># list of child gridspecs for this figure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gridspecs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># TODO: I&#39;d like to dynamically add the _repr_html_ method</span>
    <span class="c1"># to the figure in the right context, but then IPython doesn&#39;t</span>
    <span class="c1"># use it, for some reason.</span>

    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># We can&#39;t use &quot;isinstance&quot; here, because then we&#39;d end up importing</span>
        <span class="c1"># webagg unconditionally.</span>
        <span class="k">if</span> <span class="s1">&#39;WebAgg&#39;</span> <span class="ow">in</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">matplotlib.backends</span> <span class="k">import</span> <span class="n">backend_webagg</span>
            <span class="k">return</span> <span class="n">backend_webagg</span><span class="o">.</span><span class="n">ipython_inline_display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">warn</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If using a GUI backend with pyplot, display the figure window.</span>

<span class="sd">        If the figure was not created using</span>
<span class="sd">        :func:`~matplotlib.pyplot.figure`, it will lack a</span>
<span class="sd">        :class:`~matplotlib.backend_bases.FigureManagerBase`, and</span>
<span class="sd">        will raise an AttributeError.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            This does not manage an GUI event loop. Consequently, the figure</span>
<span class="sd">            may only be shown briefly or not shown at all if you or your</span>
<span class="sd">            environment are not managing an event loop.</span>

<span class="sd">            Proper use cases for `.Figure.show` include running this from a</span>
<span class="sd">            GUI application or an IPython shell.</span>

<span class="sd">            If you&#39;re running a pure python shell or executing a non-GUI</span>
<span class="sd">            python script, you should use `matplotlib.pyplot.show` instead,</span>
<span class="sd">            which takes care of managing the event loop for you.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        warn : bool</span>
<span class="sd">            If ``True`` and we are not running headless (i.e. on Linux with an</span>
<span class="sd">            unset DISPLAY), issue warning when called on a non-GUI backend.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">manager</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="s1">&#39;manager&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span>
                                 <span class="s2">&quot;Figure.show works only &quot;</span>
                                 <span class="s2">&quot;for figures managed by pyplot, normally &quot;</span>
                                 <span class="s2">&quot;created by pyplot.figure().&quot;</span> <span class="o">%</span> <span class="n">err</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">manager</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">manager</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="k">except</span> <span class="n">NonGuiException</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">backends</span><span class="o">.</span><span class="n">_get_running_interactive_framework</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;headless&quot;</span>
                <span class="ow">and</span> <span class="n">warn</span><span class="p">):</span>
            <span class="n">cbook</span><span class="o">.</span><span class="n">_warn_external</span><span class="p">(</span><span class="s1">&#39;Matplotlib is currently using </span><span class="si">%s</span><span class="s1">, which is &#39;</span>
                                 <span class="s1">&#39;a non-GUI backend, so cannot show the &#39;</span>
                                 <span class="s1">&#39;figure.&#39;</span> <span class="o">%</span> <span class="n">get_backend</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_get_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">as_list</span><span class="p">()</span>

    <span class="n">axes</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">_get_axes</span><span class="p">,</span>
                    <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;List of axes in the Figure. You can access the &quot;</span>
                        <span class="s2">&quot;axes in the Figure through this list. &quot;</span>
                        <span class="s2">&quot;Do not modify the list itself. Instead, use &quot;</span>
                        <span class="s2">&quot;`~Figure.add_axes`, `~.Figure.subplot` or &quot;</span>
                        <span class="s2">&quot;`~.Figure.delaxes` to add or remove an axes.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_dpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dpi</span>

    <span class="k">def</span> <span class="nf">_set_dpi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dpi</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dpi : float</span>

<span class="sd">        forward : bool</span>
<span class="sd">            Passed on to `~.Figure.set_size_inches`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dpi</span> <span class="o">=</span> <span class="n">dpi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dpi_scale_trans</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">dpi</span><span class="p">,</span> <span class="n">dpi</span><span class="p">)</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="n">forward</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="s1">&#39;dpi_changed&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="n">dpi</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_dpi</span><span class="p">,</span> <span class="n">_set_dpi</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;The resolution in dots per inch.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_tight_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return whether `.tight_layout` is called when drawing.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tight</span>

    <span class="k">def</span> <span class="nf">set_tight_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tight</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set whether and how `.tight_layout` is called when drawing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tight : bool or dict with keys &quot;pad&quot;, &quot;w_pad&quot;, &quot;h_pad&quot;, &quot;rect&quot; or None</span>
<span class="sd">            If a bool, sets whether to call `.tight_layout` upon drawing.</span>
<span class="sd">            If ``None``, use the ``figure.autolayout`` rcparam instead.</span>
<span class="sd">            If a dict, pass it as kwargs to `.tight_layout`, overriding the</span>
<span class="sd">            default paddings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tight</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tight</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.autolayout&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tight</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">tight</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tight_parameters</span> <span class="o">=</span> <span class="n">tight</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tight</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">get_constrained_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a boolean: True means constrained layout is being used.</span>

<span class="sd">        See :doc:`/tutorials/intermediate/constrainedlayout_guide`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constrained</span>

    <span class="k">def</span> <span class="nf">set_constrained_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constrained</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set whether ``constrained_layout`` is used upon drawing. If None,</span>
<span class="sd">        the rcParams[&#39;figure.constrained_layout.use&#39;] value will be used.</span>

<span class="sd">        When providing a dict containing the keys `w_pad`, `h_pad`</span>
<span class="sd">        the default ``constrained_layout`` paddings will be</span>
<span class="sd">        overridden.  These pads are in inches and default to 3.0/72.0.</span>
<span class="sd">        ``w_pad`` is the width padding and ``h_pad`` is the height padding.</span>

<span class="sd">        See :doc:`/tutorials/intermediate/constrainedlayout_guide`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        constrained : bool or dict or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_constrained_layout_pads</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_constrained_layout_pads</span><span class="p">[</span><span class="s1">&#39;w_pad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_constrained_layout_pads</span><span class="p">[</span><span class="s1">&#39;h_pad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_constrained_layout_pads</span><span class="p">[</span><span class="s1">&#39;wspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_constrained_layout_pads</span><span class="p">[</span><span class="s1">&#39;hspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">constrained</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">constrained</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.constrained_layout.use&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_constrained</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">constrained</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">constrained</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_constrained_layout_pads</span><span class="p">(</span><span class="o">**</span><span class="n">constrained</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_constrained_layout_pads</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">set_constrained_layout_pads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set padding for ``constrained_layout``.  Note the kwargs can be passed</span>
<span class="sd">        as a dictionary ``fig.set_constrained_layout(**paddict)``.</span>

<span class="sd">        See :doc:`/tutorials/intermediate/constrainedlayout_guide`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        w_pad : scalar</span>
<span class="sd">            Width padding in inches.  This is the pad around axes</span>
<span class="sd">            and is meant to make sure there is enough room for fonts to</span>
<span class="sd">            look good.  Defaults to 3 pts = 0.04167 inches</span>

<span class="sd">        h_pad : scalar</span>
<span class="sd">            Height padding in inches. Defaults to 3 pts.</span>

<span class="sd">        wspace : scalar</span>
<span class="sd">            Width padding between subplots, expressed as a fraction of the</span>
<span class="sd">            subplot width.  The total padding ends up being w_pad + wspace.</span>

<span class="sd">        hspace : scalar</span>
<span class="sd">            Height padding between subplots, expressed as a fraction of the</span>
<span class="sd">            subplot width. The total padding ends up being h_pad + hspace.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">todo</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;w_pad&#39;</span><span class="p">,</span> <span class="s1">&#39;h_pad&#39;</span><span class="p">,</span> <span class="s1">&#39;wspace&#39;</span><span class="p">,</span> <span class="s1">&#39;hspace&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">td</span> <span class="ow">in</span> <span class="n">todo</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">td</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">td</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_constrained_layout_pads</span><span class="p">[</span><span class="n">td</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">td</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_constrained_layout_pads</span><span class="p">[</span><span class="n">td</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.constrained_layout.&#39;</span> <span class="o">+</span> <span class="n">td</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">get_constrained_layout_pads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get padding for ``constrained_layout``.</span>

<span class="sd">        Returns a list of `w_pad, h_pad` in inches and</span>
<span class="sd">        `wspace` and `hspace` as fractions of the subplot.</span>

<span class="sd">        See :doc:`/tutorials/intermediate/constrainedlayout_guide`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        relative : boolean</span>
<span class="sd">            If `True`, then convert from inches to figure relative.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">w_pad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constrained_layout_pads</span><span class="p">[</span><span class="s1">&#39;w_pad&#39;</span><span class="p">]</span>
        <span class="n">h_pad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constrained_layout_pads</span><span class="p">[</span><span class="s1">&#39;h_pad&#39;</span><span class="p">]</span>
        <span class="n">wspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constrained_layout_pads</span><span class="p">[</span><span class="s1">&#39;wspace&#39;</span><span class="p">]</span>
        <span class="n">hspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constrained_layout_pads</span><span class="p">[</span><span class="s1">&#39;hspace&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">relative</span> <span class="ow">and</span> <span class="p">(</span><span class="n">w_pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">h_pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">renderer0</span> <span class="o">=</span> <span class="n">layoutbox</span><span class="o">.</span><span class="n">get_renderer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">dpi</span> <span class="o">=</span> <span class="n">renderer0</span><span class="o">.</span><span class="n">dpi</span>
            <span class="n">w_pad</span> <span class="o">=</span> <span class="n">w_pad</span> <span class="o">*</span> <span class="n">dpi</span> <span class="o">/</span> <span class="n">renderer0</span><span class="o">.</span><span class="n">width</span>
            <span class="n">h_pad</span> <span class="o">=</span> <span class="n">h_pad</span> <span class="o">*</span> <span class="n">dpi</span> <span class="o">/</span> <span class="n">renderer0</span><span class="o">.</span><span class="n">height</span>

        <span class="k">return</span> <span class="n">w_pad</span><span class="p">,</span> <span class="n">h_pad</span><span class="p">,</span> <span class="n">wspace</span><span class="p">,</span> <span class="n">hspace</span>

    <span class="k">def</span> <span class="nf">autofmt_xdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Date ticklabels often overlap, so it is useful to rotate them</span>
<span class="sd">        and right align them.  Also, a common use case is a number of</span>
<span class="sd">        subplots with shared xaxes where the x-axis is date data.  The</span>
<span class="sd">        ticklabels are often long, and it helps to rotate them on the</span>
<span class="sd">        bottom subplot and turn them off on other subplots, as well as</span>
<span class="sd">        turn off xlabels.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bottom : scalar</span>
<span class="sd">            The bottom of the subplots for :meth:`subplots_adjust`.</span>

<span class="sd">        rotation : angle in degrees</span>
<span class="sd">            The rotation of the xtick labels.</span>

<span class="sd">        ha : string</span>
<span class="sd">            The horizontal alignment of the xticklabels.</span>

<span class="sd">        which : {None, &#39;major&#39;, &#39;minor&#39;, &#39;both&#39;}</span>
<span class="sd">            Selects which ticklabels to rotate. Default is None which works</span>
<span class="sd">            the same as major.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">allsubplots</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;is_last_row&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="n">which</span><span class="p">):</span>
                <span class="n">label</span><span class="o">.</span><span class="n">set_ha</span><span class="p">(</span><span class="n">ha</span><span class="p">)</span>
                <span class="n">label</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">allsubplots</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axes</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">is_last_row</span><span class="p">():</span>
                        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="n">which</span><span class="p">):</span>
                            <span class="n">label</span><span class="o">.</span><span class="n">set_ha</span><span class="p">(</span><span class="n">ha</span><span class="p">)</span>
                            <span class="n">label</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="n">which</span><span class="p">):</span>
                            <span class="n">label</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">allsubplots</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="n">bottom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">get_children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a list of artists contained in the figure.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">artists</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">patches</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">legends</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseevent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test whether the mouse event occurred on the figure.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            bool, {}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseevent</span><span class="p">)</span>
        <span class="n">inside</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">mouseevent</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mouseevent</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">inside</span><span class="p">,</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the figure bounding box in display space. Arguments are ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span>

    <span class="k">def</span> <span class="nf">suptitle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a centered title to the figure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t : str</span>
<span class="sd">            The title text.</span>

<span class="sd">        x : float, default 0.5</span>
<span class="sd">            The x location of the text in figure coordinates.</span>

<span class="sd">        y : float, default 0.98</span>
<span class="sd">            The y location of the text in figure coordinates.</span>

<span class="sd">        horizontalalignment, ha : {&#39;center&#39;, &#39;left&#39;, right&#39;}, default: &#39;center&#39;</span>
<span class="sd">            The horizontal alignment of the text relative to (*x*, *y*).</span>

<span class="sd">        verticalalignment, va : {&#39;top&#39;, &#39;center&#39;, &#39;bottom&#39;, &#39;baseline&#39;}, \</span>
<span class="sd">default: &#39;top&#39;</span>
<span class="sd">            The vertical alignment of the text relative to (*x*, *y*).</span>

<span class="sd">        fontsize, size : default: :rc:`figure.titlesize`</span>
<span class="sd">            The font size of the text. See `.Text.set_size` for possible</span>
<span class="sd">            values.</span>

<span class="sd">        fontweight, weight : default: :rc:`figure.titleweight`</span>
<span class="sd">            The font weight of the text. See `.Text.set_weight` for possible</span>
<span class="sd">            values.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            text</span>
<span class="sd">                The `.Text` instance of the title.</span>


<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        fontproperties : None or dict, optional</span>
<span class="sd">            A dict of font properties. If *fontproperties* is given the</span>
<span class="sd">            default values for font size and weight are taken from the</span>
<span class="sd">            `FontProperties` defaults. :rc:`figure.titlesize` and</span>
<span class="sd">            :rc:`figure.titleweight` are ignored in this case.</span>

<span class="sd">        **kwargs</span>
<span class="sd">            Additional kwargs are :class:`matplotlib.text.Text` properties.</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; fig.suptitle(&#39;This is the figure title&#39;, fontsize=12)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">manual_position</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="s1">&#39;y&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;horizontalalignment&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s1">&#39;ha&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;horizontalalignment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;verticalalignment&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s1">&#39;va&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;verticalalignment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span>

        <span class="k">if</span> <span class="s1">&#39;fontproperties&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;fontsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s1">&#39;size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.titlesize&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;fontweight&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s1">&#39;weight&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.titleweight&#39;</span><span class="p">]</span>

        <span class="n">sup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span><span class="o">.</span><span class="n">update_from</span><span class="p">(</span><span class="n">sup</span><span class="p">)</span>
            <span class="n">sup</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span> <span class="o">=</span> <span class="n">sup</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span><span class="o">.</span><span class="n">_layoutbox</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layoutbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">manual_position</span><span class="p">:</span>
                <span class="n">w_pad</span><span class="p">,</span> <span class="n">h_pad</span><span class="p">,</span> <span class="n">wspace</span><span class="p">,</span> <span class="n">hspace</span> <span class="o">=</span>  \
                        <span class="bp">self</span><span class="o">.</span><span class="n">get_constrained_layout_pads</span><span class="p">(</span><span class="n">relative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">figlb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layoutbox</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span><span class="o">.</span><span class="n">_layoutbox</span> <span class="o">=</span> <span class="n">layoutbox</span><span class="o">.</span><span class="n">LayoutBox</span><span class="p">(</span>
                        <span class="n">parent</span><span class="o">=</span><span class="n">figlb</span><span class="p">,</span> <span class="n">artist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">figlb</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.suptitle&#39;</span><span class="p">)</span>
                <span class="c1"># stack the suptitle on top of all the children.</span>
                <span class="c1"># Some day this should be on top of all the children in the</span>
                <span class="c1"># gridspec only.</span>
                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">figlb</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">child</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span><span class="o">.</span><span class="n">_layoutbox</span><span class="p">:</span>
                        <span class="n">layoutbox</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span><span class="o">.</span><span class="n">_layoutbox</span><span class="p">,</span>
                                          <span class="n">child</span><span class="p">],</span>
                                         <span class="n">padding</span><span class="o">=</span><span class="n">h_pad</span><span class="o">*</span><span class="mf">2.</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="s1">&#39;required&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span>

    <span class="k">def</span> <span class="nf">set_canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canvas</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the canvas that contains the figure</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        canvas : FigureCanvas</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">canvas</span>

    <span class="k">def</span> <span class="nf">figimage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">xo</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yo</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a non-resampled image to the figure.</span>

<span class="sd">        The image is attached to the lower or upper left corner depending on</span>
<span class="sd">        *origin*.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X</span>
<span class="sd">            The image data. This is an array of one of the following shapes:</span>

<span class="sd">            - MxN: luminance (grayscale) values</span>
<span class="sd">            - MxNx3: RGB values</span>
<span class="sd">            - MxNx4: RGBA values</span>

<span class="sd">        xo, yo : int</span>
<span class="sd">            The *x*/*y* image offset in pixels.</span>

<span class="sd">        alpha : None or float</span>
<span class="sd">            The alpha blending value.</span>

<span class="sd">        norm : :class:`matplotlib.colors.Normalize`</span>
<span class="sd">            A :class:`.Normalize` instance to map the luminance to the</span>
<span class="sd">            interval [0, 1].</span>

<span class="sd">        cmap : str or :class:`matplotlib.colors.Colormap`</span>
<span class="sd">            The colormap to use. Default: :rc:`image.cmap`.</span>

<span class="sd">        vmin, vmax : scalar</span>
<span class="sd">            If *norm* is not given, these values set the data limits for the</span>
<span class="sd">            colormap.</span>

<span class="sd">        origin : {&#39;upper&#39;, &#39;lower&#39;}</span>
<span class="sd">            Indicates where the [0, 0] index of the array is in the upper left</span>
<span class="sd">            or lower left corner of the axes. Defaults to :rc:`image.origin`.</span>

<span class="sd">        resize : bool</span>
<span class="sd">            If *True*, resize the figure to match the given image size.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`matplotlib.image.FigureImage`</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional kwargs are `.Artist` kwargs passed on to `.FigureImage`.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        figimage complements the axes image</span>
<span class="sd">        (:meth:`~matplotlib.axes.Axes.imshow`) which will be resampled</span>
<span class="sd">        to fit the current axes.  If you want a resampled image to</span>
<span class="sd">        fill the entire figure, you can define an</span>
<span class="sd">        :class:`~matplotlib.axes.Axes` with extent [0,0,1,1].</span>


<span class="sd">        Examples::</span>

<span class="sd">            f = plt.figure()</span>
<span class="sd">            nx = int(f.get_figwidth() * f.dpi)</span>
<span class="sd">            ny = int(f.get_figheight() * f.dpi)</span>
<span class="sd">            data = np.random.random((ny, nx))</span>
<span class="sd">            f.figimage(data)</span>
<span class="sd">            plt.show()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">resize</span><span class="p">:</span>
            <span class="n">dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dpi</span><span class="p">()</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">/</span> <span class="n">dpi</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">figsize</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">im</span> <span class="o">=</span> <span class="n">mimage</span><span class="o">.</span><span class="n">FigureImage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">xo</span><span class="p">,</span> <span class="n">yo</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">stale_callback</span> <span class="o">=</span> <span class="n">_stale_figure_callback</span>

        <span class="n">im</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">_remove_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">remove</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">im</span>

    <span class="k">def</span> <span class="nf">set_size_inches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the figure size in inches.</span>

<span class="sd">        Call signatures::</span>

<span class="sd">             fig.set_size_inches(w, h)  # OR</span>
<span class="sd">             fig.set_size_inches((w, h))</span>

<span class="sd">        optional kwarg *forward=True* will cause the canvas size to be</span>
<span class="sd">        automatically updated; e.g., you can resize the figure window</span>
<span class="sd">        from the shell</span>

<span class="sd">        ACCEPTS: a (w, h) tuple with w, h in inches</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.Figure.get_size_inches</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># the width and height have been passed in as a tuple to the first</span>
        <span class="c1"># argument, so unpack them</span>
        <span class="k">if</span> <span class="n">h</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">w</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;figure size must be finite not &#39;</span>
                             <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_inches</span><span class="o">.</span><span class="n">p1</span> <span class="o">=</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span>

        <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
            <span class="n">canvas</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;canvas&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">canvas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ratio</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="s1">&#39;_dpi_ratio&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">dpival</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span> <span class="o">/</span> <span class="n">ratio</span>
                <span class="n">canvasw</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">dpival</span>
                <span class="n">canvash</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">dpival</span>
                <span class="n">manager</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="s1">&#39;manager&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">manager</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">manager</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">canvasw</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">canvash</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">get_size_inches</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the current size of the figure in inches.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        size : ndarray</span>
<span class="sd">           The size (width, height) of the figure in inches.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.Figure.set_size_inches</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_inches</span><span class="o">.</span><span class="n">p1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_edgecolor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the edge color of the Figure rectangle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_edgecolor</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_facecolor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the face color of the Figure rectangle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_figwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the figure width as a float.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_inches</span><span class="o">.</span><span class="n">width</span>

    <span class="k">def</span> <span class="nf">get_figheight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the figure height as a float.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_inches</span><span class="o">.</span><span class="n">height</span>

    <span class="k">def</span> <span class="nf">get_dpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the resolution in dots per inch as a float.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span>

    <span class="k">def</span> <span class="nf">get_frameon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the figure&#39;s background patch visibility, i.e.</span>
<span class="sd">        whether the figure background will be drawn. Equivalent to</span>
<span class="sd">        ``Figure.patch.get_visible()``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_visible</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">set_edgecolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the edge color of the Figure rectangle.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        color : color</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_facecolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the face color of the Figure rectangle.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        color : color</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_dpi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the resolution of the figure in dots-per-inch.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        val : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span> <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">set_figwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the width of the figure in inches.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        val : float</span>
<span class="sd">        forward : bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figheight</span><span class="p">(),</span> <span class="n">forward</span><span class="o">=</span><span class="n">forward</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_figheight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the height of the figure in inches.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        val : float</span>
<span class="sd">        forward : bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_figwidth</span><span class="p">(),</span> <span class="n">val</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="n">forward</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_frameon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the figure&#39;s background patch visibility, i.e.</span>
<span class="sd">        whether the figure background will be drawn. Equivalent to</span>
<span class="sd">        ``Figure.patch.set_visible()``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">frameon</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_frameon</span><span class="p">,</span> <span class="n">set_frameon</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delaxes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the `~matplotlib.axes.Axes` *ax* from the figure and update the</span>
<span class="sd">        current axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axobservers</span><span class="p">:</span>
            <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">add_artist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artist</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add any :class:`~matplotlib.artist.Artist` to the figure.</span>

<span class="sd">        Usually artists are added to axes objects using</span>
<span class="sd">        :meth:`matplotlib.axes.Axes.add_artist`, but use this method in the</span>
<span class="sd">        rare cases that adding directly to the figure is necessary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        artist : `~matplotlib.artist.Artist`</span>
<span class="sd">            The artist to add to the figure. If the added artist has no</span>
<span class="sd">            transform previously set, its transform will be set to</span>
<span class="sd">            ``figure.transFigure``.</span>
<span class="sd">        clip : bool, optional, default ``False``</span>
<span class="sd">            An optional parameter ``clip`` determines whether the added artist</span>
<span class="sd">            should be clipped by the figure patch. Default is *False*,</span>
<span class="sd">            i.e. no clipping.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        artist : The added `~matplotlib.artist.Artist`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">artist</span><span class="o">.</span><span class="n">set_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">artists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">artist</span><span class="p">)</span>
        <span class="n">artist</span><span class="o">.</span><span class="n">_remove_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">artists</span><span class="o">.</span><span class="n">remove</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">artist</span><span class="o">.</span><span class="n">is_transform_set</span><span class="p">():</span>
            <span class="n">artist</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transFigure</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">clip</span><span class="p">:</span>
            <span class="n">artist</span><span class="o">.</span><span class="n">set_clip_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">artist</span>

    <span class="k">def</span> <span class="nf">_make_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Make a hashable key out of args and kwargs.&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">fixitems</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
            <span class="c1"># items may have arrays and lists in them, so convert them</span>
            <span class="c1"># to tuples for the key</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                <span class="c1"># some objects can define __getitem__ without being</span>
                <span class="c1"># iterable and in those cases the conversion to tuples</span>
                <span class="c1"># will fail. So instead of using the np.iterable(v) function</span>
                <span class="c1"># we simply try and convert to a tuple, and proceed if not.</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">fixlist</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iterable</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

        <span class="n">key</span> <span class="o">=</span> <span class="n">fixlist</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="n">fixitems</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">key</span>

    <span class="k">def</span> <span class="nf">_process_projection_requirements</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the args/kwargs to add_axes/add_subplot/gca, returning::</span>

<span class="sd">            (axes_proj_class, proj_class_kwargs, proj_stack_key)</span>

<span class="sd">        which can be used for new axes initialization/identification.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">polar</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">projection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">projection</span> <span class="o">!=</span> <span class="s1">&#39;polar&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;polar=True, yet projection=</span><span class="si">%r</span><span class="s2">. &quot;</span>
                    <span class="s2">&quot;Only one of these arguments should be supplied.&quot;</span> <span class="o">%</span>
                    <span class="n">projection</span><span class="p">)</span>
            <span class="n">projection</span> <span class="o">=</span> <span class="s1">&#39;polar&#39;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">projection</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="n">projection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">projection_class</span> <span class="o">=</span> <span class="n">projections</span><span class="o">.</span><span class="n">get_projection_class</span><span class="p">(</span><span class="n">projection</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">projection</span><span class="p">,</span> <span class="s1">&#39;_as_mpl_axes&#39;</span><span class="p">):</span>
            <span class="n">projection_class</span><span class="p">,</span> <span class="n">extra_kwargs</span> <span class="o">=</span> <span class="n">projection</span><span class="o">.</span><span class="n">_as_mpl_axes</span><span class="p">()</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">extra_kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;projection must be a string, None or implement a &#39;</span>
                            <span class="s1">&#39;_as_mpl_axes method. Got </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">projection</span><span class="p">)</span>

        <span class="c1"># Make the key without projection kwargs, this is used as a unique</span>
        <span class="c1"># lookup for axes instances</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_key</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">projection_class</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">key</span>

    <span class="nd">@docstring</span><span class="o">.</span><span class="n">dedent_interpd</span>
    <span class="k">def</span> <span class="nf">add_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an axes to the figure.</span>

<span class="sd">        Call signatures::</span>

<span class="sd">            add_axes(rect, projection=None, polar=False, **kwargs)</span>
<span class="sd">            add_axes(ax)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        rect : sequence of float</span>
<span class="sd">            The dimensions [left, bottom, width, height] of the new axes. All</span>
<span class="sd">            quantities are in fractions of figure width and height.</span>

<span class="sd">        projection : {None, &#39;aitoff&#39;, &#39;hammer&#39;, &#39;lambert&#39;, &#39;mollweide&#39;, \</span>
<span class="sd">&#39;polar&#39;, &#39;rectilinear&#39;, str}, optional</span>
<span class="sd">            The projection type of the `~.axes.Axes`. *str* is the name of</span>
<span class="sd">            a custom projection, see `~matplotlib.projections`. The default</span>
<span class="sd">            None results in a &#39;rectilinear&#39; projection.</span>

<span class="sd">        polar : boolean, optional</span>
<span class="sd">            If True, equivalent to projection=&#39;polar&#39;.</span>

<span class="sd">        sharex, sharey : `~.axes.Axes`, optional</span>
<span class="sd">            Share the x or y `~matplotlib.axis` with sharex and/or sharey.</span>
<span class="sd">            The axis will have the same limits, ticks, and scale as the axis</span>
<span class="sd">            of the shared axes.</span>

<span class="sd">        label : str</span>
<span class="sd">            A label for the returned axes.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs</span>
<span class="sd">            This method also takes the keyword arguments for</span>
<span class="sd">            the returned axes class. The keyword arguments for the</span>
<span class="sd">            rectilinear axes class `~.axes.Axes` can be found in</span>
<span class="sd">            the following table but there might also be other keyword</span>
<span class="sd">            arguments if another projection is used, see the actual axes</span>
<span class="sd">            class.</span>
<span class="sd">            %(Axes)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        axes : `~.axes.Axes` (or a subclass of `~.axes.Axes`)</span>
<span class="sd">            The returned axes class depends on the projection used. It is</span>
<span class="sd">            `~.axes.Axes` if rectilinear projection are used and</span>
<span class="sd">            `.projections.polar.PolarAxes` if polar projection</span>
<span class="sd">            are used.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If the figure already has an axes with key (*args*,</span>
<span class="sd">        *kwargs*) then it will simply make that axes current and</span>
<span class="sd">        return it.  This behavior is deprecated. Meanwhile, if you do</span>
<span class="sd">        not want this behavior (i.e., you want to force the creation of a</span>
<span class="sd">        new axes), you must use a unique set of args and kwargs.  The axes</span>
<span class="sd">        *label* attribute has been exposed for this purpose: if you want</span>
<span class="sd">        two axes that are otherwise identical to be added to the figure,</span>
<span class="sd">        make sure you give them unique labels.</span>

<span class="sd">        In rare circumstances, `.add_axes` may be called with a single</span>
<span class="sd">        argument, a axes instance already created in the present figure but</span>
<span class="sd">        not in the figure&#39;s list of axes.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .Figure.add_subplot</span>
<span class="sd">        .pyplot.subplot</span>
<span class="sd">        .pyplot.axes</span>
<span class="sd">        .Figure.subplots</span>
<span class="sd">        .pyplot.subplots</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Some simple examples::</span>

<span class="sd">            rect = l, b, w, h</span>
<span class="sd">            fig = plt.figure()</span>
<span class="sd">            fig.add_axes(rect,label=label1)</span>
<span class="sd">            fig.add_axes(rect,label=label2)</span>
<span class="sd">            fig.add_axes(rect, frameon=False, facecolor=&#39;g&#39;)</span>
<span class="sd">            fig.add_axes(rect, polar=True)</span>
<span class="sd">            ax=fig.add_axes(rect, projection=&#39;polar&#39;)</span>
<span class="sd">            fig.delaxes(ax)</span>
<span class="sd">            fig.add_axes(ax)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="c1"># shortcut the projection &quot;key&quot; modifications later on, if an axes</span>
        <span class="c1"># with the exact args/kwargs exists, return it immediately.</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_key</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ax</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Axes</span><span class="p">):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;The Axes must have been created in the present figure&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rect</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;all entries in rect must be finite &#39;</span>
                                 <span class="s1">&#39;not </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rect</span><span class="p">))</span>
            <span class="n">projection_class</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_process_projection_requirements</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="c1"># check that an axes of this type doesn&#39;t already exist, if it</span>
            <span class="c1"># does, set it as active and return it</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">projection_class</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">ax</span>

            <span class="c1"># create the new axes using the axes class given</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">projection_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_axes_internal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

    <span class="nd">@docstring</span><span class="o">.</span><span class="n">dedent_interpd</span>
    <span class="k">def</span> <span class="nf">add_subplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an `~.axes.Axes` to the figure as part of a subplot arrangement.</span>

<span class="sd">        Call signatures::</span>

<span class="sd">           add_subplot(nrows, ncols, index, **kwargs)</span>
<span class="sd">           add_subplot(pos, **kwargs)</span>
<span class="sd">           add_subplot(ax)</span>
<span class="sd">           add_subplot()</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Either a 3-digit integer or three separate integers</span>
<span class="sd">            describing the position of the subplot. If the three</span>
<span class="sd">            integers are *nrows*, *ncols*, and *index* in order, the</span>
<span class="sd">            subplot will take the *index* position on a grid with *nrows*</span>
<span class="sd">            rows and *ncols* columns. *index* starts at 1 in the upper left</span>
<span class="sd">            corner and increases to the right.</span>

<span class="sd">            *pos* is a three digit integer, where the first digit is the</span>
<span class="sd">            number of rows, the second the number of columns, and the third</span>
<span class="sd">            the index of the subplot. i.e. fig.add_subplot(235) is the same as</span>
<span class="sd">            fig.add_subplot(2, 3, 5). Note that all integers must be less than</span>
<span class="sd">            10 for this form to work.</span>

<span class="sd">            If no positional arguments are passed, defaults to (1, 1, 1).</span>

<span class="sd">            In rare circumstances, `.add_subplot` may be called with a single</span>
<span class="sd">            argument, a subplot axes instance already created in the</span>
<span class="sd">            present figure but not in the figure&#39;s list of axes.</span>

<span class="sd">        projection : {None, &#39;aitoff&#39;, &#39;hammer&#39;, &#39;lambert&#39;, &#39;mollweide&#39;, \</span>
<span class="sd">&#39;polar&#39;, &#39;rectilinear&#39;, str}, optional</span>
<span class="sd">            The projection type of the subplot (`~.axes.Axes`). *str* is the</span>
<span class="sd">            name of a custom projection, see `~matplotlib.projections`. The</span>
<span class="sd">            default None results in a &#39;rectilinear&#39; projection.</span>

<span class="sd">        polar : boolean, optional</span>
<span class="sd">            If True, equivalent to projection=&#39;polar&#39;.</span>

<span class="sd">        sharex, sharey : `~.axes.Axes`, optional</span>
<span class="sd">            Share the x or y `~matplotlib.axis` with sharex and/or sharey.</span>
<span class="sd">            The axis will have the same limits, ticks, and scale as the axis</span>
<span class="sd">            of the shared axes.</span>

<span class="sd">        label : str</span>
<span class="sd">            A label for the returned axes.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs</span>
<span class="sd">            This method also takes the keyword arguments for</span>
<span class="sd">            the returned axes base class. The keyword arguments for the</span>
<span class="sd">            rectilinear base class `~.axes.Axes` can be found in</span>
<span class="sd">            the following table but there might also be other keyword</span>
<span class="sd">            arguments if another projection is used.</span>
<span class="sd">            %(Axes)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        axes : `.axes.SubplotBase`, or another subclass of `~.axes.Axes`</span>

<span class="sd">            The axes of the subplot. The returned axes base class depends on</span>
<span class="sd">            the projection used. It is `~.axes.Axes` if rectilinear projection</span>
<span class="sd">            are used and `.projections.polar.PolarAxes` if polar projection</span>
<span class="sd">            are used. The returned axes is then a subplot subclass of the</span>
<span class="sd">            base class.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If the figure already has a subplot with key (*args*,</span>
<span class="sd">        *kwargs*) then it will simply make that subplot current and</span>
<span class="sd">        return it.  This behavior is deprecated. Meanwhile, if you do</span>
<span class="sd">        not want this behavior (i.e., you want to force the creation of a</span>
<span class="sd">        new subplot), you must use a unique set of args and kwargs.  The axes</span>
<span class="sd">        *label* attribute has been exposed for this purpose: if you want</span>
<span class="sd">        two subplots that are otherwise identical to be added to the figure,</span>
<span class="sd">        make sure you give them unique labels.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .Figure.add_axes</span>
<span class="sd">        .pyplot.subplot</span>
<span class="sd">        .pyplot.axes</span>
<span class="sd">        .Figure.subplots</span>
<span class="sd">        .pyplot.subplots</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ::</span>

<span class="sd">            fig = plt.figure()</span>
<span class="sd">            fig.add_subplot(221)</span>

<span class="sd">            # equivalent but more general</span>
<span class="sd">            ax1 = fig.add_subplot(2, 2, 1)</span>

<span class="sd">            # add a subplot with no frame</span>
<span class="sd">            ax2 = fig.add_subplot(222, frameon=False)</span>

<span class="sd">            # add a polar subplot</span>
<span class="sd">            fig.add_subplot(223, projection=&#39;polar&#39;)</span>

<span class="sd">            # add a red subplot that share the x-axis with ax1</span>
<span class="sd">            fig.add_subplot(224, sharex=ax1, facecolor=&#39;red&#39;)</span>

<span class="sd">            #delete x2 from the figure</span>
<span class="sd">            fig.delaxes(ax2)</span>

<span class="sd">            #add x2 to the figure again</span>
<span class="sd">            fig.add_subplot(ax2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Integral</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="mi">100</span> <span class="o">&lt;=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">999</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Integer subplot specification must be a &quot;</span>
                                 <span class="s2">&quot;three-digit number, not </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SubplotBase</span><span class="p">):</span>

            <span class="n">a</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;The Subplot must have been created in the present figure&quot;</span><span class="p">)</span>
            <span class="c1"># make a key for the subplot (which includes the axes object id</span>
            <span class="c1"># in the hash)</span>
            <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_key</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">projection_class</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_process_projection_requirements</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="c1"># try to find the axes with this key in the stack</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">projection_class</span><span class="p">):</span>
                    <span class="c1"># the axes already existed, so set it as active &amp; return</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">ax</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Undocumented convenience behavior:</span>
                    <span class="c1"># subplot(111); subplot(111, projection=&#39;polar&#39;)</span>
                    <span class="c1"># will replace the first with the second.</span>
                    <span class="c1"># Without this, add_subplot would be simpler and</span>
                    <span class="c1"># more similar to add_axes.</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

            <span class="n">a</span> <span class="o">=</span> <span class="n">subplot_class_factory</span><span class="p">(</span><span class="n">projection_class</span><span class="p">)(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_axes_internal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_axes_internal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Private helper for `add_axes` and `add_subplot`.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">_remove_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remove_ax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">stale_callback</span> <span class="o">=</span> <span class="n">_stale_figure_callback</span>
        <span class="k">return</span> <span class="n">ax</span>

    <span class="k">def</span> <span class="nf">subplots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a set of subplots to this figure.</span>

<span class="sd">        This utility wrapper makes it convenient to create common layouts of</span>
<span class="sd">        subplots in a single call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nrows, ncols : int, optional, default: 1</span>
<span class="sd">            Number of rows/columns of the subplot grid.</span>

<span class="sd">        sharex, sharey : bool or {&#39;none&#39;, &#39;all&#39;, &#39;row&#39;, &#39;col&#39;}, default: False</span>
<span class="sd">            Controls sharing of properties among x (`sharex`) or y (`sharey`)</span>
<span class="sd">            axes:</span>

<span class="sd">                - True or &#39;all&#39;: x- or y-axis will be shared among all</span>
<span class="sd">                  subplots.</span>
<span class="sd">                - False or &#39;none&#39;: each subplot x- or y-axis will be</span>
<span class="sd">                  independent.</span>
<span class="sd">                - &#39;row&#39;: each subplot row will share an x- or y-axis.</span>
<span class="sd">                - &#39;col&#39;: each subplot column will share an x- or y-axis.</span>

<span class="sd">            When subplots have a shared x-axis along a column, only the x tick</span>
<span class="sd">            labels of the bottom subplot are created. Similarly, when subplots</span>
<span class="sd">            have a shared y-axis along a row, only the y tick labels of the</span>
<span class="sd">            first column subplot are created. To later turn other subplots&#39;</span>
<span class="sd">            ticklabels on, use `~matplotlib.axes.Axes.tick_params`.</span>

<span class="sd">        squeeze : bool, optional, default: True</span>
<span class="sd">            - If True, extra dimensions are squeezed out from the returned</span>
<span class="sd">              array of Axes:</span>

<span class="sd">                - if only one subplot is constructed (nrows=ncols=1), the</span>
<span class="sd">                  resulting single Axes object is returned as a scalar.</span>
<span class="sd">                - for Nx1 or 1xM subplots, the returned object is a 1D numpy</span>
<span class="sd">                  object array of Axes objects.</span>
<span class="sd">                - for NxM, subplots with N&gt;1 and M&gt;1 are returned</span>
<span class="sd">                  as a 2D array.</span>

<span class="sd">            - If False, no squeezing at all is done: the returned Axes object</span>
<span class="sd">              is always a 2D array containing Axes instances, even if it ends</span>
<span class="sd">              up being 1x1.</span>

<span class="sd">        subplot_kw : dict, optional</span>
<span class="sd">            Dict with keywords passed to the</span>
<span class="sd">            :meth:`~matplotlib.figure.Figure.add_subplot` call used to create</span>
<span class="sd">            each subplot.</span>

<span class="sd">        gridspec_kw : dict, optional</span>
<span class="sd">            Dict with keywords passed to the</span>
<span class="sd">            `~matplotlib.gridspec.GridSpec` constructor used to create</span>
<span class="sd">            the grid the subplots are placed on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : `~.axes.Axes` object or array of Axes objects.</span>
<span class="sd">            *ax* can be either a single `~matplotlib.axes.Axes` object or</span>
<span class="sd">            an array of Axes objects if more than one subplot was created. The</span>
<span class="sd">            dimensions of the resulting array can be controlled with the</span>
<span class="sd">            squeeze keyword, see above.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ::</span>

<span class="sd">            # First create some toy data:</span>
<span class="sd">            x = np.linspace(0, 2*np.pi, 400)</span>
<span class="sd">            y = np.sin(x**2)</span>

<span class="sd">            # Create a figure</span>
<span class="sd">            plt.figure()</span>

<span class="sd">            # Creates a subplot</span>
<span class="sd">            ax = fig.subplots()</span>
<span class="sd">            ax.plot(x, y)</span>
<span class="sd">            ax.set_title(&#39;Simple plot&#39;)</span>

<span class="sd">            # Creates two subplots and unpacks the output array immediately</span>
<span class="sd">            ax1, ax2 = fig.subplots(1, 2, sharey=True)</span>
<span class="sd">            ax1.plot(x, y)</span>
<span class="sd">            ax1.set_title(&#39;Sharing Y axis&#39;)</span>
<span class="sd">            ax2.scatter(x, y)</span>

<span class="sd">            # Creates four polar axes, and accesses them through the</span>
<span class="sd">            # returned array</span>
<span class="sd">            axes = fig.subplots(2, 2, subplot_kw=dict(polar=True))</span>
<span class="sd">            axes[0, 0].plot(x, y)</span>
<span class="sd">            axes[1, 1].scatter(x, y)</span>

<span class="sd">            # Share a X axis with each column of subplots</span>
<span class="sd">            fig.subplots(2, 2, sharex=&#39;col&#39;)</span>

<span class="sd">            # Share a Y axis with each row of subplots</span>
<span class="sd">            fig.subplots(2, 2, sharey=&#39;row&#39;)</span>

<span class="sd">            # Share both X and Y axes with all subplots</span>
<span class="sd">            fig.subplots(2, 2, sharex=&#39;all&#39;, sharey=&#39;all&#39;)</span>

<span class="sd">            # Note that this is the same as</span>
<span class="sd">            fig.subplots(2, 2, sharex=True, sharey=True)</span>

<span class="sd">            See Also</span>
<span class="sd">            --------</span>
<span class="sd">            .pyplot.subplots</span>
<span class="sd">            .Figure.add_subplot</span>
<span class="sd">            .pyplot.subplot</span>
<span class="sd">            &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sharex</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">sharex</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span> <span class="k">if</span> <span class="n">sharex</span> <span class="k">else</span> <span class="s2">&quot;none&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sharey</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">sharey</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span> <span class="k">if</span> <span class="n">sharey</span> <span class="k">else</span> <span class="s2">&quot;none&quot;</span>
        <span class="c1"># This check was added because it is very easy to type</span>
        <span class="c1"># `subplots(1, 2, 1)` when `subplot(1, 2, 1)` was intended.</span>
        <span class="c1"># In most cases, no error will ever occur, but mysterious behavior</span>
        <span class="c1"># will result because what was intended to be the subplot index is</span>
        <span class="c1"># instead treated as a bool for sharex.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sharex</span><span class="p">,</span> <span class="n">Integral</span><span class="p">):</span>
            <span class="n">cbook</span><span class="o">.</span><span class="n">_warn_external</span><span class="p">(</span>
                <span class="s2">&quot;sharex argument to subplots() was an integer.  Did you &quot;</span>
                <span class="s2">&quot;intend to use subplot() (without &#39;s&#39;)?&quot;</span><span class="p">)</span>
        <span class="n">cbook</span><span class="o">.</span><span class="n">_check_in_list</span><span class="p">([</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;row&quot;</span><span class="p">,</span> <span class="s2">&quot;col&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">],</span>
                             <span class="n">sharex</span><span class="o">=</span><span class="n">sharex</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subplot_kw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subplot_kw</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">gridspec_kw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gridspec_kw</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># don&#39;t mutate kwargs passed by user...</span>
        <span class="n">subplot_kw</span> <span class="o">=</span> <span class="n">subplot_kw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">gridspec_kw</span> <span class="o">=</span> <span class="n">gridspec_kw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_constrained_layout</span><span class="p">():</span>
            <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">gridspec_kw</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># this should turn constrained_layout off if we don&#39;t want it</span>
            <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">gridspec_kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gridspecs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gs</span><span class="p">)</span>

        <span class="c1"># Create array to hold all axes.</span>
        <span class="n">axarr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
                <span class="n">shared_with</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;none&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                               <span class="s2">&quot;row&quot;</span><span class="p">:</span> <span class="n">axarr</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">]}</span>
                <span class="n">subplot_kw</span><span class="p">[</span><span class="s2">&quot;sharex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shared_with</span><span class="p">[</span><span class="n">sharex</span><span class="p">]</span>
                <span class="n">subplot_kw</span><span class="p">[</span><span class="s2">&quot;sharey&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shared_with</span><span class="p">[</span><span class="n">sharey</span><span class="p">]</span>
                <span class="n">axarr</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">],</span> <span class="o">**</span><span class="n">subplot_kw</span><span class="p">)</span>

        <span class="c1"># turn off redundant tick labeling</span>
        <span class="k">if</span> <span class="n">sharex</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;col&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">]:</span>
            <span class="c1"># turn off all but the bottom row</span>
            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axarr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                                         <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sharey</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;row&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">]:</span>
            <span class="c1"># turn off all but the first column</span>
            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axarr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                                         <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">squeeze</span><span class="p">:</span>
            <span class="c1"># Discarding unneeded dimensions that equal 1.  If we only have one</span>
            <span class="c1"># subplot, just return it instead of a 1-element array.</span>
            <span class="k">return</span> <span class="n">axarr</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">if</span> <span class="n">axarr</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">axarr</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Returned axis array will be always 2-d, even if nrows=ncols=1.</span>
            <span class="k">return</span> <span class="n">axarr</span>

    <span class="k">def</span> <span class="nf">_remove_ax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">_reset_loc_form</span><span class="p">(</span><span class="n">axis</span><span class="p">):</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">get_major_formatter</span><span class="p">())</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">get_major_locator</span><span class="p">())</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">get_minor_formatter</span><span class="p">())</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">get_minor_locator</span><span class="p">())</span>

        <span class="k">def</span> <span class="nf">_break_share_link</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">grouper</span><span class="p">):</span>
            <span class="n">siblings</span> <span class="o">=</span> <span class="n">grouper</span><span class="o">.</span><span class="n">get_siblings</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">siblings</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">grouper</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">last_ax</span> <span class="ow">in</span> <span class="n">siblings</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">last_ax</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">last_ax</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">last_ax</span> <span class="o">=</span> <span class="n">_break_share_link</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">_shared_y_axes</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">last_ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_reset_loc_form</span><span class="p">(</span><span class="n">last_ax</span><span class="o">.</span><span class="n">yaxis</span><span class="p">)</span>

        <span class="n">last_ax</span> <span class="o">=</span> <span class="n">_break_share_link</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">_shared_x_axes</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">last_ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_reset_loc_form</span><span class="p">(</span><span class="n">last_ax</span><span class="o">.</span><span class="n">xaxis</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep_observers</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clear the figure.</span>

<span class="sd">        Set *keep_observers* to True if, for example,</span>
<span class="sd">        a gui widget is tracking the axes in the figure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suppressComposite</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">CallbackRegistry</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">):</span>  <span class="c1"># Iterate over the copy.</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>         <span class="c1"># removes ax from self._axstack</span>

        <span class="n">toolbar</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="s1">&#39;toolbar&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">toolbar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">toolbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">artists</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">keep_observers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_axobservers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_constrained_layout</span><span class="p">():</span>
            <span class="n">layoutbox</span><span class="o">.</span><span class="n">nonetree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_layoutbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep_observers</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clear the figure -- synonym for :meth:`clf`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clf</span><span class="p">(</span><span class="n">keep_observers</span><span class="o">=</span><span class="n">keep_observers</span><span class="p">)</span>

    <span class="nd">@allow_rasterization</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Render the figure using :class:`matplotlib.backend_bases.RendererBase`</span>
<span class="sd">        instance *renderer*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># draw the figure bounding box, perhaps none for white figure</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">artists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_children</span><span class="p">()</span>
        <span class="n">artists</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="p">)</span>
        <span class="n">artists</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="p">(</span><span class="n">artist</span> <span class="k">for</span> <span class="n">artist</span> <span class="ow">in</span> <span class="n">artists</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_animated</span><span class="p">()),</span>
            <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">artist</span><span class="p">:</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_zorder</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_axes_locator</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">locator</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">locator</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">apply_aspect</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">apply_aspect</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="s1">&#39;apply_aspect&#39;</span><span class="p">):</span>
                    <span class="n">locator</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">get_axes_locator</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">locator</span><span class="p">:</span>
                        <span class="n">pos</span> <span class="o">=</span> <span class="n">locator</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
                        <span class="n">child</span><span class="o">.</span><span class="n">apply_aspect</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">child</span><span class="o">.</span><span class="n">apply_aspect</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">renderer</span><span class="o">.</span><span class="n">open_group</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_constrained_layout</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">execute_constrained_layout</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tight_layout</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span>
                                      <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_tight_parameters</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">pass</span>
                    <span class="c1"># ValueError can occur when resizing a window.</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="n">mimage</span><span class="o">.</span><span class="n">_draw_list_compositing_images</span><span class="p">(</span>
                <span class="n">renderer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">artists</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">suppressComposite</span><span class="p">)</span>

            <span class="n">renderer</span><span class="o">.</span><span class="n">close_group</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cachedRenderer</span> <span class="o">=</span> <span class="n">renderer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_event</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">draw_artist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw :class:`matplotlib.artist.Artist` instance *a* only.</span>
<span class="sd">        This is available only after the figure is drawn.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachedRenderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;draw_artist can only be used after an &quot;</span>
                                 <span class="s2">&quot;initial draw which caches the renderer&quot;</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cachedRenderer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of axes in the Figure. You can access and modify the</span>
<span class="sd">        axes in the Figure through this list.</span>

<span class="sd">        Do not modify the list itself. Instead, use `~Figure.add_axes`,</span>
<span class="sd">        `~.Figure.subplot` or `~.Figure.delaxes` to add or remove an axes.</span>

<span class="sd">        Note: This is equivalent to the property `~.Figure.axes`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>

    <span class="c1"># Note: in the docstring below, the newlines in the examples after the</span>
    <span class="c1"># calls to legend() allow replacing it with figlegend() to generate the</span>
    <span class="c1"># docstring of pyplot.figlegend.</span>

    <span class="nd">@docstring</span><span class="o">.</span><span class="n">dedent_interpd</span>
    <span class="k">def</span> <span class="nf">legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Place a legend on the figure.</span>

<span class="sd">        To make a legend from existing artists on every axes::</span>

<span class="sd">          legend()</span>

<span class="sd">        To make a legend for a list of lines and labels::</span>

<span class="sd">          legend(</span>
<span class="sd">              (line1, line2, line3),</span>
<span class="sd">              (&#39;label1&#39;, &#39;label2&#39;, &#39;label3&#39;),</span>
<span class="sd">              loc=&#39;upper right&#39;)</span>

<span class="sd">        These can also be specified by keyword::</span>

<span class="sd">          legend(</span>
<span class="sd">              handles=(line1, line2, line3),</span>
<span class="sd">              labels=(&#39;label1&#39;, &#39;label2&#39;, &#39;label3&#39;),</span>
<span class="sd">              loc=&#39;upper right&#39;)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        handles : sequence of `.Artist`, optional</span>
<span class="sd">            A list of Artists (lines, patches) to be added to the legend.</span>
<span class="sd">            Use this together with *labels*, if you need full control on what</span>
<span class="sd">            is shown in the legend and the automatic mechanism described above</span>
<span class="sd">            is not sufficient.</span>

<span class="sd">            The length of handles and labels should be the same in this</span>
<span class="sd">            case. If they are not, they are truncated to the smaller length.</span>

<span class="sd">        labels : sequence of strings, optional</span>
<span class="sd">            A list of labels to show next to the artists.</span>
<span class="sd">            Use this together with *handles*, if you need full control on what</span>
<span class="sd">            is shown in the legend and the automatic mechanism described above</span>
<span class="sd">            is not sufficient.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>

<span class="sd">        %(_legend_kw_doc)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`matplotlib.legend.Legend` instance</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Not all kinds of artist are supported by the legend command. See</span>
<span class="sd">        :doc:`/tutorials/intermediate/legend_guide` for details.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">extra_args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">mlegend</span><span class="o">.</span><span class="n">_parse_legend_args</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span>
                <span class="o">*</span><span class="n">args</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># check for third arg</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">extra_args</span><span class="p">):</span>
            <span class="c1"># cbook.warn_deprecated(</span>
            <span class="c1">#     &quot;2.1&quot;,</span>
            <span class="c1">#     message=&quot;Figure.legend will accept no more than two &quot;</span>
            <span class="c1">#     &quot;positional arguments in the future.  Use &quot;</span>
            <span class="c1">#     &quot;&#39;fig.legend(handles, labels, loc=location)&#39; &quot;</span>
            <span class="c1">#     &quot;instead.&quot;)</span>
            <span class="c1"># kwargs[&#39;loc&#39;] = extra_args[0]</span>
            <span class="c1"># extra_args = extra_args[1:]</span>
            <span class="k">pass</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">mlegend</span><span class="o">.</span><span class="n">Legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="o">*</span><span class="n">extra_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="n">l</span><span class="o">.</span><span class="n">_remove_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">legends</span><span class="o">.</span><span class="n">remove</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">l</span>

    <span class="nd">@cbook</span><span class="o">.</span><span class="n">_delete_parameter</span><span class="p">(</span><span class="s2">&quot;3.1&quot;</span><span class="p">,</span> <span class="s2">&quot;withdash&quot;</span><span class="p">)</span>
    <span class="nd">@docstring</span><span class="o">.</span><span class="n">dedent_interpd</span>
    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">withdash</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add text to figure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x, y : float</span>
<span class="sd">            The position to place the text. By default, this is in figure</span>
<span class="sd">            coordinates, floats in [0, 1]. The coordinate system can be changed</span>
<span class="sd">            using the *transform* keyword.</span>

<span class="sd">        s : str</span>
<span class="sd">            The text string.</span>

<span class="sd">        fontdict : dictionary, optional, default: None</span>
<span class="sd">            A dictionary to override the default text properties. If fontdict</span>
<span class="sd">            is None, the defaults are determined by your rc parameters. A</span>
<span class="sd">            property in *kwargs* override the same property in fontdict.</span>

<span class="sd">        withdash : boolean, optional, default: False</span>
<span class="sd">            Creates a `~matplotlib.text.TextWithDash` instance instead of a</span>
<span class="sd">            `~matplotlib.text.Text` instance.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs : `~matplotlib.text.Text` properties</span>
<span class="sd">            Other miscellaneous text parameters.</span>
<span class="sd">            %(Text)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        text : `~.text.Text`</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .Axes.text</span>
<span class="sd">        .pyplot.text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">default</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transFigure</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">withdash</span>
                <span class="ow">and</span> <span class="n">withdash</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">cbook</span><span class="o">.</span><span class="n">deprecation</span><span class="o">.</span><span class="n">_deprecated_parameter</span><span class="p">):</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">TextWithDash</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>

        <span class="n">text</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fontdict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fontdict</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">text</span><span class="o">.</span><span class="n">set_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">stale_callback</span> <span class="o">=</span> <span class="n">_stale_figure_callback</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">_remove_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="o">.</span><span class="n">remove</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">text</span>

    <span class="k">def</span> <span class="nf">_set_artist_props</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">set_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">stale_callback</span> <span class="o">=</span> <span class="n">_stale_figure_callback</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transFigure</span><span class="p">)</span>

    <span class="nd">@docstring</span><span class="o">.</span><span class="n">dedent_interpd</span>
    <span class="k">def</span> <span class="nf">gca</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the current axes, creating one if necessary.</span>

<span class="sd">        The following kwargs are supported for ensuring the returned axes</span>
<span class="sd">        adheres to the given projection etc., and for axes creation if</span>
<span class="sd">        the active axes does not exist:</span>

<span class="sd">        %(Axes)s</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ckey</span><span class="p">,</span> <span class="n">cax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">current_key_axes</span><span class="p">()</span>
        <span class="c1"># if there exists an axes on the stack see if it matches</span>
        <span class="c1"># the desired axes configuration</span>
        <span class="k">if</span> <span class="n">cax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="c1"># if no kwargs are given just return the current axes</span>
            <span class="c1"># this is a convenience for gca() on axes such as polar etc.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cax</span>

            <span class="c1"># if the user has specified particular projection detail</span>
            <span class="c1"># then build up a key which can represent this</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">projection_class</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">_process_projection_requirements</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

                <span class="c1"># let the returned axes have any gridspec by removing it from</span>
                <span class="c1"># the key</span>
                <span class="n">ckey</span> <span class="o">=</span> <span class="n">ckey</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

                <span class="c1"># if the cax matches this key then return the axes, otherwise</span>
                <span class="c1"># continue and a new axes will be created</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">ckey</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">projection_class</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">cax</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cbook</span><span class="o">.</span><span class="n">_warn_external</span><span class="p">(</span><span class="s1">&#39;Requested projection is different &#39;</span>
                                         <span class="s1">&#39;from current axis projection, &#39;</span>
                                         <span class="s1">&#39;creating new axis with requested &#39;</span>
                                         <span class="s1">&#39;projection.&#39;</span><span class="p">)</span>

        <span class="c1"># no axes found, so create one which spans the figure</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sca</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the current axes to be a and return a.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">bubble</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axobservers</span><span class="p">:</span>
            <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span>

    <span class="k">def</span> <span class="nf">_gci</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper for :func:`~matplotlib.pyplot.gci`. Do not use elsewhere.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Look first for an image in the current Axes:</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">current_key_axes</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">cax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">cax</span><span class="o">.</span><span class="n">_gci</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">im</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">im</span>

        <span class="c1"># If there is no image in the current Axes, search for</span>
        <span class="c1"># one in a previously created Axes.  Whether this makes</span>
        <span class="c1"># sense is debatable, but it is the documented behavior.</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">):</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">_gci</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">im</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">im</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__getstate__</span><span class="p">()</span>

        <span class="c1"># the axobservers cannot currently be pickled.</span>
        <span class="c1"># Additionally, the canvas cannot currently be pickled, but this has</span>
        <span class="c1"># the benefit of meaning that a figure can be detached from one canvas,</span>
        <span class="c1"># and re-attached to another.</span>
        <span class="k">for</span> <span class="n">attr_to_pop</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;_axobservers&#39;</span><span class="p">,</span> <span class="s1">&#39;show&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;canvas&#39;</span><span class="p">,</span> <span class="s1">&#39;_cachedRenderer&#39;</span><span class="p">):</span>
            <span class="n">state</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">attr_to_pop</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># add version information to the state</span>
        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;__mpl_version__&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_mpl_version</span>

        <span class="c1"># check whether the figure manager (if any) is registered with pyplot</span>
        <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">_pylab_helpers</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="s1">&#39;manager&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> \
                <span class="ow">in</span> <span class="n">_pylab_helpers</span><span class="o">.</span><span class="n">Gcf</span><span class="o">.</span><span class="n">figs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">state</span><span class="p">[</span><span class="s1">&#39;_restore_to_pylab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># set all the layoutbox information to None.  kiwisolver objects can&#39;t</span>
        <span class="c1"># be pickled, so we lose the layout options at this point.</span>
        <span class="n">state</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;_layoutbox&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="c1"># suptitle:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span><span class="o">.</span><span class="n">_layoutbox</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="n">version</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;__mpl_version__&#39;</span><span class="p">)</span>
        <span class="n">restore_to_pylab</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;_restore_to_pylab&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">version</span> <span class="o">!=</span> <span class="n">_mpl_version</span><span class="p">:</span>
            <span class="n">cbook</span><span class="o">.</span><span class="n">_warn_external</span><span class="p">(</span>
                <span class="n">f</span><span class="s2">&quot;This figure was saved with matplotlib version </span><span class="si">{version}</span><span class="s2"> and &quot;</span>
                <span class="n">f</span><span class="s2">&quot;is unlikely to function correctly.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">=</span> <span class="n">state</span>

        <span class="c1"># re-initialise some of the unstored state information</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axobservers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_layoutbox</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">restore_to_pylab</span><span class="p">:</span>
            <span class="c1"># lazy import to avoid circularity</span>
            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
            <span class="kn">import</span> <span class="nn">matplotlib._pylab_helpers</span> <span class="k">as</span> <span class="nn">pylab_helpers</span>
            <span class="n">allnums</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_fignums</span><span class="p">()</span>
            <span class="n">num</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">allnums</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">allnums</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="n">mgr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">_backend_mod</span><span class="o">.</span><span class="n">new_figure_manager_given_figure</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

            <span class="c1"># XXX The following is a copy and paste from pyplot. Consider</span>
            <span class="c1"># factoring to pylab_helpers</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_label</span><span class="p">():</span>
                <span class="n">mgr</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_label</span><span class="p">())</span>

            <span class="c1"># make this figure current on button press event</span>
            <span class="k">def</span> <span class="nf">make_active</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
                <span class="n">pylab_helpers</span><span class="o">.</span><span class="n">Gcf</span><span class="o">.</span><span class="n">set_active</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span>

            <span class="n">mgr</span><span class="o">.</span><span class="n">_cidgcf</span> <span class="o">=</span> <span class="n">mgr</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;button_press_event&#39;</span><span class="p">,</span>
                                                 <span class="n">make_active</span><span class="p">)</span>

            <span class="n">pylab_helpers</span><span class="o">.</span><span class="n">Gcf</span><span class="o">.</span><span class="n">set_active</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">num</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">draw_if_interactive</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">add_axobserver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Whenever the axes state change, ``func(self)`` will be called.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axobservers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">savefig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the current figure.</span>

<span class="sd">        Call signature::</span>

<span class="sd">          savefig(fname, dpi=None, facecolor=&#39;w&#39;, edgecolor=&#39;w&#39;,</span>
<span class="sd">                  orientation=&#39;portrait&#39;, papertype=None, format=None,</span>
<span class="sd">                  transparent=False, bbox_inches=None, pad_inches=0.1,</span>
<span class="sd">                  frameon=None, metadata=None)</span>

<span class="sd">        The output formats available depend on the backend being used.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        fname : str or PathLike or file-like object</span>
<span class="sd">            A path, or a Python file-like object, or</span>
<span class="sd">            possibly some backend-dependent object such as</span>
<span class="sd">            `matplotlib.backends.backend_pdf.PdfPages`.</span>

<span class="sd">            If *format* is not set, then the output format is inferred from</span>
<span class="sd">            the extension of *fname*, if any, and from :rc:`savefig.format`</span>
<span class="sd">            otherwise.  If *format* is set, it determines the output format.</span>

<span class="sd">            Hence, if *fname* is not a path or has no extension, remember to</span>
<span class="sd">            specify *format* to ensure that the correct backend is used.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>

<span class="sd">        dpi : [ *None* | scalar &gt; 0 | &#39;figure&#39; ]</span>
<span class="sd">            The resolution in dots per inch.  If *None*, defaults to</span>
<span class="sd">            :rc:`savefig.dpi`.  If &#39;figure&#39;, uses the figure&#39;s dpi value.</span>

<span class="sd">        quality : [ *None* | 1 &lt;= scalar &lt;= 100 ]</span>
<span class="sd">            The image quality, on a scale from 1 (worst) to 95 (best).</span>
<span class="sd">            Applicable only if *format* is jpg or jpeg, ignored otherwise.</span>
<span class="sd">            If *None*, defaults to :rc:`savefig.jpeg_quality` (95 by default).</span>
<span class="sd">            Values above 95 should be avoided; 100 completely disables the</span>
<span class="sd">            JPEG quantization stage.</span>

<span class="sd">        optimize : bool</span>
<span class="sd">            If *True*, indicates that the JPEG encoder should make an extra</span>
<span class="sd">            pass over the image in order to select optimal encoder settings.</span>
<span class="sd">            Applicable only if *format* is jpg or jpeg, ignored otherwise.</span>
<span class="sd">            Is *False* by default.</span>

<span class="sd">        progressive : bool</span>
<span class="sd">            If *True*, indicates that this image should be stored as a</span>
<span class="sd">            progressive JPEG file. Applicable only if *format* is jpg or</span>
<span class="sd">            jpeg, ignored otherwise. Is *False* by default.</span>

<span class="sd">        facecolor : color spec or None, optional</span>
<span class="sd">            The facecolor of the figure; if *None*, defaults to</span>
<span class="sd">            :rc:`savefig.facecolor`.</span>

<span class="sd">        edgecolor : color spec or None, optional</span>
<span class="sd">            The edgecolor of the figure; if *None*, defaults to</span>
<span class="sd">            :rc:`savefig.edgecolor`</span>

<span class="sd">        orientation : {&#39;landscape&#39;, &#39;portrait&#39;}</span>
<span class="sd">            Currently only supported by the postscript backend.</span>

<span class="sd">        papertype : str</span>
<span class="sd">            One of &#39;letter&#39;, &#39;legal&#39;, &#39;executive&#39;, &#39;ledger&#39;, &#39;a0&#39; through</span>
<span class="sd">            &#39;a10&#39;, &#39;b0&#39; through &#39;b10&#39;. Only supported for postscript</span>
<span class="sd">            output.</span>

<span class="sd">        format : str</span>
<span class="sd">            The file format, e.g. &#39;png&#39;, &#39;pdf&#39;, &#39;svg&#39;, ... The behavior when</span>
<span class="sd">            this is unset is documented under *fname*.</span>

<span class="sd">        transparent : bool</span>
<span class="sd">            If *True*, the axes patches will all be transparent; the</span>
<span class="sd">            figure patch will also be transparent unless facecolor</span>
<span class="sd">            and/or edgecolor are specified via kwargs.</span>
<span class="sd">            This is useful, for example, for displaying</span>
<span class="sd">            a plot on top of a colored background on a web page.  The</span>
<span class="sd">            transparency of these patches will be restored to their</span>
<span class="sd">            original values upon exit of this function.</span>

<span class="sd">        bbox_inches : str or `~matplotlib.transforms.Bbox`, optional</span>
<span class="sd">            Bbox in inches. Only the given portion of the figure is</span>
<span class="sd">            saved. If &#39;tight&#39;, try to figure out the tight bbox of</span>
<span class="sd">            the figure. If None, use savefig.bbox</span>

<span class="sd">        pad_inches : scalar, optional</span>
<span class="sd">            Amount of padding around the figure when bbox_inches is</span>
<span class="sd">            &#39;tight&#39;. If None, use savefig.pad_inches</span>

<span class="sd">        bbox_extra_artists : list of `~matplotlib.artist.Artist`, optional</span>
<span class="sd">            A list of extra artists that will be considered when the</span>
<span class="sd">            tight bbox is calculated.</span>

<span class="sd">        metadata : dict, optional</span>
<span class="sd">            Key/value pairs to store in the image metadata. The supported keys</span>
<span class="sd">            and defaults depend on the image format and backend:</span>

<span class="sd">            - &#39;png&#39; with Agg backend: See the parameter ``metadata`` of</span>
<span class="sd">              `~.FigureCanvasAgg.print_png`.</span>
<span class="sd">            - &#39;pdf&#39; with pdf backend: See the parameter ``metadata`` of</span>
<span class="sd">              `~.backend_pdf.PdfPages`.</span>
<span class="sd">            - &#39;eps&#39; and &#39;ps&#39; with PS backend: Only &#39;Creator&#39; is supported.</span>

<span class="sd">        pil_kwargs : dict, optional</span>
<span class="sd">            Additional keyword arguments that are passed to `PIL.Image.save`</span>
<span class="sd">            when saving the figure.  Only applicable for formats that are saved</span>
<span class="sd">            using Pillow, i.e. JPEG, TIFF, and (if the keyword is set to a</span>
<span class="sd">            non-None value) PNG.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;dpi&#39;</span><span class="p">,</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.dpi&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;frameon&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">cbook</span><span class="o">.</span><span class="n">warn_deprecated</span><span class="p">(</span><span class="s2">&quot;3.1&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;frameon&quot;</span><span class="p">,</span> <span class="n">obj_type</span><span class="o">=</span><span class="s2">&quot;kwarg&quot;</span><span class="p">,</span>
                                  <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;facecolor&quot;</span><span class="p">)</span>
            <span class="n">frameon</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;frameon&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">frameon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">frameon</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">rcParams</span><span class="p">,</span> <span class="s1">&#39;savefig.frameon&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">frameon</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Won&#39;t pass &quot;if frameon:&quot; below.</span>
        <span class="k">if</span> <span class="n">transparent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">transparent</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.transparent&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">transparent</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;facecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span>
            <span class="n">original_axes_colors</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                <span class="n">patch</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">patch</span>
                <span class="n">original_axes_colors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">patch</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">(),</span>
                                             <span class="n">patch</span><span class="o">.</span><span class="n">get_edgecolor</span><span class="p">()))</span>
                <span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
                <span class="n">patch</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;facecolor&#39;</span><span class="p">,</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.facecolor&#39;</span><span class="p">])</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">,</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.edgecolor&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">frameon</span><span class="p">:</span>
            <span class="n">original_frameon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_visible</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">frameon</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">print_figure</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">frameon</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">original_frameon</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">transparent</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">original_axes_colors</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">cc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">cc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="nd">@docstring</span><span class="o">.</span><span class="n">dedent_interpd</span>
    <span class="k">def</span> <span class="nf">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mappable</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_gridspec</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a colorbar for a ScalarMappable instance, *mappable*.</span>

<span class="sd">        Documentation for the pyplot thin wrapper:</span>
<span class="sd">        %(colorbar_doc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="c1"># Store the value of gca so that we can set it back later on.</span>
        <span class="n">current_ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">cax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">use_gridspec</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">SubplotBase</span><span class="p">)</span>  \
                     <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_constrained_layout</span><span class="p">()):</span>
                <span class="n">cax</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">cbar</span><span class="o">.</span><span class="n">make_axes_gridspec</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cax</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">cbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

        <span class="c1"># need to remove kws that cannot be passed to Colorbar</span>
        <span class="n">NON_COLORBAR_KEYS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fraction&#39;</span><span class="p">,</span> <span class="s1">&#39;pad&#39;</span><span class="p">,</span> <span class="s1">&#39;shrink&#39;</span><span class="p">,</span> <span class="s1">&#39;aspect&#39;</span><span class="p">,</span> <span class="s1">&#39;anchor&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;panchor&#39;</span><span class="p">]</span>
        <span class="n">cb_kw</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kw</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NON_COLORBAR_KEYS</span><span class="p">}</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">cbar</span><span class="o">.</span><span class="n">colorbar_factory</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">mappable</span><span class="p">,</span> <span class="o">**</span><span class="n">cb_kw</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">current_ax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">cb</span>

    <span class="k">def</span> <span class="nf">subplots_adjust</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">wspace</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the :class:`SubplotParams` with *kwargs* (defaulting to rc when</span>
<span class="sd">        *None*) and update the subplot locations.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_constrained_layout</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_constrained_layout</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">cbook</span><span class="o">.</span><span class="n">_warn_external</span><span class="p">(</span><span class="s2">&quot;This figure was using &quot;</span>
                                 <span class="s2">&quot;constrained_layout==True, but that is &quot;</span>
                                 <span class="s2">&quot;incompatible with subplots_adjust and or &quot;</span>
                                 <span class="s2">&quot;tight_layout: setting &quot;</span>
                                 <span class="s2">&quot;constrained_layout==False. &quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplotpars</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">wspace</span><span class="p">,</span> <span class="n">hspace</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">SubplotBase</span><span class="p">):</span>
                <span class="c1"># Check if sharing a subplots axis</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">_sharex</span><span class="p">,</span> <span class="n">SubplotBase</span><span class="p">):</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">_sharex</span><span class="o">.</span><span class="n">update_params</span><span class="p">()</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">_sharex</span><span class="o">.</span><span class="n">figbox</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">_sharey</span><span class="p">,</span> <span class="n">SubplotBase</span><span class="p">):</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">_sharey</span><span class="o">.</span><span class="n">update_params</span><span class="p">()</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">_sharey</span><span class="o">.</span><span class="n">figbox</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">update_params</span><span class="p">()</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">figbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">ginput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">show_clicks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mouse_add</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">mouse_pop</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">mouse_stop</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Blocking call to interact with a figure.</span>

<span class="sd">        Wait until the user clicks *n* times on the figure, and return the</span>
<span class="sd">        coordinates of each click in a list.</span>

<span class="sd">        There are three possible interactions:</span>

<span class="sd">        - Add a point.</span>
<span class="sd">        - Remove the most recently added point.</span>
<span class="sd">        - Stop the interaction and return the points added so far.</span>

<span class="sd">        The actions are assigned to mouse buttons via the arguments</span>
<span class="sd">        *mouse_add*, *mouse_pop* and *mouse_stop*. Mouse buttons are defined</span>
<span class="sd">        by the numbers:</span>

<span class="sd">        - 1: left mouse button</span>
<span class="sd">        - 2: middle mouse button</span>
<span class="sd">        - 3: right mouse button</span>
<span class="sd">        - None: no mouse button</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n : int, optional, default: 1</span>
<span class="sd">            Number of mouse clicks to accumulate. If negative, accumulate</span>
<span class="sd">            clicks until the input is terminated manually.</span>
<span class="sd">        timeout : scalar, optional, default: 30</span>
<span class="sd">            Number of seconds to wait before timing out. If zero or negative</span>
<span class="sd">            will never timeout.</span>
<span class="sd">        show_clicks : bool, optional, default: True</span>
<span class="sd">            If True, show a red cross at the location of each click.</span>
<span class="sd">        mouse_add : {1, 2, 3, None}, optional, default: 1 (left click)</span>
<span class="sd">            Mouse button used to add points.</span>
<span class="sd">        mouse_pop : {1, 2, 3, None}, optional, default: 3 (right click)</span>
<span class="sd">            Mouse button used to remove the most recently added point.</span>
<span class="sd">        mouse_stop : {1, 2, 3, None}, optional, default: 2 (middle click)</span>
<span class="sd">            Mouse button used to stop input.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        points : list of tuples</span>
<span class="sd">            A list of the clicked (x, y) coordinates.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The keyboard can also be used to select points in case your mouse</span>
<span class="sd">        does not have one or more of the buttons.  The delete and backspace</span>
<span class="sd">        keys act like right clicking (i.e., remove last point), the enter key</span>
<span class="sd">        terminates input and any other key (not already used by the window</span>
<span class="sd">        manager) selects a point.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">blocking_mouse_input</span> <span class="o">=</span> <span class="n">BlockingMouseInput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                                  <span class="n">mouse_add</span><span class="o">=</span><span class="n">mouse_add</span><span class="p">,</span>
                                                  <span class="n">mouse_pop</span><span class="o">=</span><span class="n">mouse_pop</span><span class="p">,</span>
                                                  <span class="n">mouse_stop</span><span class="o">=</span><span class="n">mouse_stop</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">blocking_mouse_input</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
                                    <span class="n">show_clicks</span><span class="o">=</span><span class="n">show_clicks</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">waitforbuttonpress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Blocking call to interact with the figure.</span>

<span class="sd">        This will return True is a key was pressed, False if a mouse</span>
<span class="sd">        button was pressed and None if *timeout* was reached without</span>
<span class="sd">        either being pressed.</span>

<span class="sd">        If *timeout* is negative, does not timeout.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">blocking_input</span> <span class="o">=</span> <span class="n">BlockingKeyMouseInput</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">blocking_input</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_default_bbox_extra_artists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bbox_artists</span> <span class="o">=</span> <span class="p">[</span><span class="n">artist</span> <span class="k">for</span> <span class="n">artist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_children</span><span class="p">()</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">artist</span><span class="o">.</span><span class="n">get_visible</span><span class="p">()</span> <span class="ow">and</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_in_layout</span><span class="p">())]</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
                <span class="n">bbox_artists</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_default_bbox_extra_artists</span><span class="p">())</span>
        <span class="c1"># we don&#39;t want the figure&#39;s patch to influence the bbox calculation</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch</span> <span class="ow">in</span> <span class="n">bbox_artists</span><span class="p">:</span>
            <span class="n">bbox_artists</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bbox_artists</span>

    <span class="k">def</span> <span class="nf">get_tightbbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">bbox_extra_artists</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a (tight) bounding box of the figure in inches.</span>

<span class="sd">        Artists that have ``artist.set_in_layout(False)`` are not included</span>
<span class="sd">        in the bbox.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        renderer : `.RendererBase` instance</span>
<span class="sd">            renderer that will be used to draw the figures (i.e.</span>
<span class="sd">            ``fig.canvas.get_renderer()``)</span>

<span class="sd">        bbox_extra_artists : list of `.Artist` or ``None``</span>
<span class="sd">            List of artists to include in the tight bounding box.  If</span>
<span class="sd">            ``None`` (default), then all artist children of each axes are</span>
<span class="sd">            included in the tight bounding box.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bbox : `.BboxBase`</span>
<span class="sd">            containing the bounding box (in figure inches).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">bb</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">bbox_extra_artists</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">artists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_bbox_extra_artists</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">artists</span> <span class="o">=</span> <span class="n">bbox_extra_artists</span>

        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">artists</span><span class="p">:</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">get_tightbbox</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">bb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
                <span class="c1"># some axes don&#39;t take the bbox_extra_artists kwarg so we</span>
                <span class="c1"># need this conditional....</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_tightbbox</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span>
                            <span class="n">bbox_extra_artists</span><span class="o">=</span><span class="n">bbox_extra_artists</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_tightbbox</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
                <span class="n">bb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bb</span>
              <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
                  <span class="ow">and</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">width</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">b</span><span class="o">.</span><span class="n">height</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bb</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_inches</span>

        <span class="n">_bbox</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">bb</span><span class="p">)</span>

        <span class="n">bbox_inches</span> <span class="o">=</span> <span class="n">TransformedBbox</span><span class="p">(</span><span class="n">_bbox</span><span class="p">,</span>
                                      <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">bbox_inches</span>

    <span class="k">def</span> <span class="nf">init_layoutbox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the layoutbox for use in constrained_layout.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layoutbox</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_layoutbox</span> <span class="o">=</span> <span class="n">layoutbox</span><span class="o">.</span><span class="n">LayoutBox</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">name</span><span class="o">=</span><span class="s1">&#39;figlb&#39;</span><span class="p">,</span>
                                     <span class="n">artist</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_layoutbox</span><span class="o">.</span><span class="n">constrain_geometry</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">execute_constrained_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use ``layoutbox`` to determine pos positions within axes.</span>

<span class="sd">        See also `.set_constrained_layout_pads`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">matplotlib._constrained_layout</span> <span class="k">import</span> <span class="n">do_constrained_layout</span>

        <span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Executing constrainedlayout&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layoutbox</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cbook</span><span class="o">.</span><span class="n">_warn_external</span><span class="p">(</span><span class="s2">&quot;Calling figure.constrained_layout, but &quot;</span>
                                 <span class="s2">&quot;figure not setup to do constrained layout. &quot;</span>
                                 <span class="s2">&quot; You either called GridSpec without the &quot;</span>
                                 <span class="s2">&quot;fig keyword, you are using plt.subplot, &quot;</span>
                                 <span class="s2">&quot;or you need to call figure or subplots &quot;</span>
                                 <span class="s2">&quot;with the constrained_layout=True kwarg.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">w_pad</span><span class="p">,</span> <span class="n">h_pad</span><span class="p">,</span> <span class="n">wspace</span><span class="p">,</span> <span class="n">hspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_constrained_layout_pads</span><span class="p">()</span>
        <span class="c1"># convert to unit-relative lengths</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span>
        <span class="n">w_pad</span> <span class="o">=</span> <span class="n">w_pad</span> <span class="o">/</span> <span class="n">width</span>
        <span class="n">h_pad</span> <span class="o">=</span> <span class="n">h_pad</span> <span class="o">/</span> <span class="n">height</span>
        <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">renderer</span> <span class="o">=</span> <span class="n">layoutbox</span><span class="o">.</span><span class="n">get_renderer</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">do_constrained_layout</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">h_pad</span><span class="p">,</span> <span class="n">w_pad</span><span class="p">,</span> <span class="n">hspace</span><span class="p">,</span> <span class="n">wspace</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tight_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">1.08</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">rect</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Automatically adjust subplot parameters to give specified padding.</span>

<span class="sd">        To exclude an artist on the axes from the bounding box calculation</span>
<span class="sd">        that determines the subplot parameters (i.e. legend, or annotation),</span>
<span class="sd">        then set `a.set_in_layout(False)` for that artist.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        renderer : subclass of `~.backend_bases.RendererBase`, optional</span>
<span class="sd">            Defaults to the renderer for the figure.</span>

<span class="sd">        pad : float, optional</span>
<span class="sd">            Padding between the figure edge and the edges of subplots,</span>
<span class="sd">            as a fraction of the font size.</span>
<span class="sd">        h_pad, w_pad : float, optional</span>
<span class="sd">            Padding (height/width) between edges of adjacent subplots,</span>
<span class="sd">            as a fraction of the font size.  Defaults to *pad*.</span>
<span class="sd">        rect : tuple (left, bottom, right, top), optional</span>
<span class="sd">            A rectangle (left, bottom, right, top) in the normalized</span>
<span class="sd">            figure coordinate that the whole subplots area (including</span>
<span class="sd">            labels) will fit into. Default is (0, 0, 1, 1).</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .Figure.set_tight_layout</span>
<span class="sd">        .pyplot.tight_layout</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">.tight_layout</span> <span class="k">import</span> <span class="p">(</span>
            <span class="n">get_renderer</span><span class="p">,</span> <span class="n">get_subplotspec_list</span><span class="p">,</span> <span class="n">get_tight_layout_figure</span><span class="p">)</span>

        <span class="n">subplotspec_list</span> <span class="o">=</span> <span class="n">get_subplotspec_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">subplotspec_list</span><span class="p">:</span>
            <span class="n">cbook</span><span class="o">.</span><span class="n">_warn_external</span><span class="p">(</span><span class="s2">&quot;This figure includes Axes that are not &quot;</span>
                                 <span class="s2">&quot;compatible with tight_layout, so results &quot;</span>
                                 <span class="s2">&quot;might be incorrect.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">renderer</span> <span class="o">=</span> <span class="n">get_renderer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">get_tight_layout_figure</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">subplotspec_list</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span>
            <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="n">h_pad</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="n">w_pad</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="n">rect</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">align_xlabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Align the ylabels of subplots in the same subplot column if label</span>
<span class="sd">        alignment is being done automatically (i.e. the label position is</span>
<span class="sd">        not manually set).</span>

<span class="sd">        Alignment persists for draw events after this is called.</span>

<span class="sd">        If a label is on the bottom, it is aligned with labels on axes that</span>
<span class="sd">        also have their label on the bottom and that have the same</span>
<span class="sd">        bottom-most subplot row.  If the label is on the top,</span>
<span class="sd">        it is aligned with labels on axes with the same top-most row.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axs : list of `~matplotlib.axes.Axes`</span>
<span class="sd">            Optional list of (or ndarray) `~matplotlib.axes.Axes`</span>
<span class="sd">            to align the xlabels.</span>
<span class="sd">            Default is to align all axes on the figure.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.figure.Figure.align_ylabels</span>

<span class="sd">        matplotlib.figure.Figure.align_labels</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This assumes that ``axs`` are from the same `.GridSpec`, so that</span>
<span class="sd">        their `.SubplotSpec` positions correspond to figure positions.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Example with rotated xtick labels::</span>

<span class="sd">            fig, axs = plt.subplots(1, 2)</span>
<span class="sd">            for tick in axs[0].get_xticklabels():</span>
<span class="sd">                tick.set_rotation(55)</span>
<span class="sd">            axs[0].set_xlabel(&#39;XLabel 0&#39;)</span>
<span class="sd">            axs[1].set_xlabel(&#39;XLabel 1&#39;)</span>
<span class="sd">            fig.align_xlabels()</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">axs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">axs</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
            <span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39; Working on: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlabel</span><span class="p">())</span>
            <span class="n">ss</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span>
            <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">row0</span><span class="p">,</span> <span class="n">row1</span><span class="p">,</span> <span class="n">col0</span><span class="p">,</span> <span class="n">col1</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">get_rows_columns</span><span class="p">()</span>
            <span class="n">labpo</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_label_position</span><span class="p">()</span>  <span class="c1"># top or bottom</span>

            <span class="c1"># loop through other axes, and search for label positions</span>
            <span class="c1"># that are same as this one, and that share the appropriate</span>
            <span class="c1"># row number.</span>
            <span class="c1">#  Add to a grouper associated with each axes of sibblings.</span>
            <span class="c1"># This list is inspected in `axis.draw` by</span>
            <span class="c1"># `axis._update_label_position`.</span>
            <span class="k">for</span> <span class="n">axc</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">axc</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_label_position</span><span class="p">()</span> <span class="o">==</span> <span class="n">labpo</span><span class="p">:</span>
                    <span class="n">ss</span> <span class="o">=</span> <span class="n">axc</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span>
                    <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">rowc0</span><span class="p">,</span> <span class="n">rowc1</span><span class="p">,</span> <span class="n">colc</span><span class="p">,</span> <span class="n">col1</span> <span class="o">=</span> \
                            <span class="n">ss</span><span class="o">.</span><span class="n">get_rows_columns</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">labpo</span> <span class="o">==</span> <span class="s1">&#39;bottom&#39;</span> <span class="ow">and</span> <span class="n">rowc1</span> <span class="o">==</span> <span class="n">row1</span> <span class="ow">or</span>
                        <span class="n">labpo</span> <span class="o">==</span> <span class="s1">&#39;top&#39;</span> <span class="ow">and</span> <span class="n">rowc0</span> <span class="o">==</span> <span class="n">row0</span><span class="p">):</span>
                        <span class="c1"># grouper for groups of xlabels to align</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_align_xlabel_grp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">axc</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">align_ylabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Align the ylabels of subplots in the same subplot column if label</span>
<span class="sd">        alignment is being done automatically (i.e. the label position is</span>
<span class="sd">        not manually set).</span>

<span class="sd">        Alignment persists for draw events after this is called.</span>

<span class="sd">        If a label is on the left, it is aligned with labels on axes that</span>
<span class="sd">        also have their label on the left and that have the same</span>
<span class="sd">        left-most subplot column.  If the label is on the right,</span>
<span class="sd">        it is aligned with labels on axes with the same right-most column.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axs : list of `~matplotlib.axes.Axes`</span>
<span class="sd">            Optional list (or ndarray) of `~matplotlib.axes.Axes`</span>
<span class="sd">            to align the ylabels.</span>
<span class="sd">            Default is to align all axes on the figure.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.figure.Figure.align_xlabels</span>

<span class="sd">        matplotlib.figure.Figure.align_labels</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This assumes that ``axs`` are from the same `.GridSpec`, so that</span>
<span class="sd">        their `.SubplotSpec` positions correspond to figure positions.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Example with large yticks labels::</span>

<span class="sd">            fig, axs = plt.subplots(2, 1)</span>
<span class="sd">            axs[0].plot(np.arange(0, 1000, 50))</span>
<span class="sd">            axs[0].set_ylabel(&#39;YLabel 0&#39;)</span>
<span class="sd">            axs[1].set_ylabel(&#39;YLabel 1&#39;)</span>
<span class="sd">            fig.align_ylabels()</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">axs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">axs</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
            <span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39; Working on: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">())</span>
            <span class="n">ss</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span>
            <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">row0</span><span class="p">,</span> <span class="n">row1</span><span class="p">,</span> <span class="n">col0</span><span class="p">,</span> <span class="n">col1</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">get_rows_columns</span><span class="p">()</span>
            <span class="n">labpo</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_label_position</span><span class="p">()</span>  <span class="c1"># left or right</span>
            <span class="c1"># loop through other axes, and search for label positions</span>
            <span class="c1"># that are same as this one, and that share the appropriate</span>
            <span class="c1"># column number.</span>
            <span class="c1"># Add to a list associated with each axes of sibblings.</span>
            <span class="c1"># This list is inspected in `axis.draw` by</span>
            <span class="c1"># `axis._update_label_position`.</span>
            <span class="k">for</span> <span class="n">axc</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">axc</span> <span class="o">!=</span> <span class="n">ax</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">axc</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_label_position</span><span class="p">()</span> <span class="o">==</span> <span class="n">labpo</span><span class="p">:</span>
                        <span class="n">ss</span> <span class="o">=</span> <span class="n">axc</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span>
                        <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">row0</span><span class="p">,</span> <span class="n">row1</span><span class="p">,</span> <span class="n">colc0</span><span class="p">,</span> <span class="n">colc1</span> <span class="o">=</span> \
                                <span class="n">ss</span><span class="o">.</span><span class="n">get_rows_columns</span><span class="p">()</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">labpo</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span> <span class="ow">and</span> <span class="n">colc0</span> <span class="o">==</span> <span class="n">col0</span> <span class="ow">or</span>
                            <span class="n">labpo</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span> <span class="ow">and</span> <span class="n">colc1</span> <span class="o">==</span> <span class="n">col1</span><span class="p">):</span>
                            <span class="c1"># grouper for groups of ylabels to align</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_align_ylabel_grp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">axc</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">align_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Align the xlabels and ylabels of subplots with the same subplots</span>
<span class="sd">        row or column (respectively) if label alignment is being</span>
<span class="sd">        done automatically (i.e. the label position is not manually set).</span>

<span class="sd">        Alignment persists for draw events after this is called.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axs : list of `~matplotlib.axes.Axes`</span>
<span class="sd">            Optional list (or ndarray) of `~matplotlib.axes.Axes`</span>
<span class="sd">            to align the labels.</span>
<span class="sd">            Default is to align all axes on the figure.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.figure.Figure.align_xlabels</span>

<span class="sd">        matplotlib.figure.Figure.align_ylabels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">align_xlabels</span><span class="p">(</span><span class="n">axs</span><span class="o">=</span><span class="n">axs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">align_ylabels</span><span class="p">(</span><span class="n">axs</span><span class="o">=</span><span class="n">axs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_gridspec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a `.GridSpec` that has this figure as a parent.  This allows</span>
<span class="sd">        complex layout of axes in the figure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nrows : int</span>
<span class="sd">            Number of rows in grid.</span>

<span class="sd">        ncols : int</span>
<span class="sd">            Number or columns in grid.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gridspec : `.GridSpec`</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Keyword arguments are passed to `.GridSpec`.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.pyplot.subplots</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Adding a subplot that spans two rows::</span>

<span class="sd">            fig = plt.figure()</span>
<span class="sd">            gs = fig.add_gridspec(2, 2)</span>
<span class="sd">            ax1 = fig.add_subplot(gs[0, 0])</span>
<span class="sd">            ax2 = fig.add_subplot(gs[1, 0])</span>
<span class="sd">            # spans two rows:</span>
<span class="sd">            ax3 = fig.add_subplot(gs[:, 1])</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># pop in case user has added this...</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gridspecs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gs</span>


<span class="k">def</span> <span class="nf">figaspect</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the width and height for a figure with a specified aspect ratio.</span>

<span class="sd">    While the height is taken from :rc:`figure.figsize`, the width is</span>
<span class="sd">    adjusted to match the desired aspect ratio. Additionally, it is ensured</span>
<span class="sd">    that the width is in the range [4., 16.] and the height is in the range</span>
<span class="sd">    [2., 16.]. If necessary, the default height is adjusted to ensure this.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    arg : scalar or 2d array</span>
<span class="sd">        If a scalar, this defines the aspect ratio (i.e. the ratio height /</span>
<span class="sd">        width).</span>
<span class="sd">        In case of an array the aspect ratio is number of rows / number of</span>
<span class="sd">        columns, so that the array could be fitted in the figure undistorted.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    width, height</span>
<span class="sd">        The figure size in inches.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    If you want to create an axes within the figure, that still preserves the</span>
<span class="sd">    aspect ratio, be sure to create it with equal width and height. See</span>
<span class="sd">    examples below.</span>

<span class="sd">    Thanks to Fernando Perez for this function.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Make a figure twice as tall as it is wide::</span>

<span class="sd">        w, h = figaspect(2.)</span>
<span class="sd">        fig = Figure(figsize=(w, h))</span>
<span class="sd">        ax = fig.add_axes([0.1, 0.1, 0.8, 0.8])</span>
<span class="sd">        ax.imshow(A, **kwargs)</span>

<span class="sd">    Make a figure with the proper aspect for an array::</span>

<span class="sd">        A = rand(5,3)</span>
<span class="sd">        w, h = figaspect(A)</span>
<span class="sd">        fig = Figure(figsize=(w, h))</span>
<span class="sd">        ax = fig.add_axes([0.1, 0.1, 0.8, 0.8])</span>
<span class="sd">        ax.imshow(A, **kwargs)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">isarray</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="s1">&#39;shape&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

    <span class="c1"># min/max sizes to respect when autoscaling.  If John likes the idea, they</span>
    <span class="c1"># could become rc parameters, for now they&#39;re hardwired.</span>
    <span class="n">figsize_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>  <span class="c1"># min length for width/height</span>
    <span class="n">figsize_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mf">16.0</span><span class="p">,</span> <span class="mf">16.0</span><span class="p">))</span>  <span class="c1"># max length for width/height</span>

    <span class="c1"># Extract the aspect ratio of the array</span>
    <span class="k">if</span> <span class="n">isarray</span><span class="p">:</span>
        <span class="n">nr</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">arr_ratio</span> <span class="o">=</span> <span class="n">nr</span> <span class="o">/</span> <span class="n">nc</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">arr_ratio</span> <span class="o">=</span> <span class="n">arg</span>

    <span class="c1"># Height of user figure defaults</span>
    <span class="n">fig_height</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># New size for the figure, keeping the aspect ratio of the caller</span>
    <span class="n">newsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">fig_height</span> <span class="o">/</span> <span class="n">arr_ratio</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">))</span>

    <span class="c1"># Sanity checks, don&#39;t drop either dimension below figsize_min</span>
    <span class="n">newsize</span> <span class="o">/=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">newsize</span> <span class="o">/</span> <span class="n">figsize_min</span><span class="p">))</span>

    <span class="c1"># Avoid humongous windows as well</span>
    <span class="n">newsize</span> <span class="o">/=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">newsize</span> <span class="o">/</span> <span class="n">figsize_max</span><span class="p">))</span>

    <span class="c1"># Finally, if we have a really funky aspect ratio, break it but respect</span>
    <span class="c1"># the min/max dimensions (we don&#39;t want figures 10 feet tall!)</span>
    <span class="n">newsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">newsize</span><span class="p">,</span> <span class="n">figsize_min</span><span class="p">,</span> <span class="n">figsize_max</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">newsize</span>

<span class="n">docstring</span><span class="o">.</span><span class="n">interpd</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">Figure</span><span class="o">=</span><span class="n">martist</span><span class="o">.</span><span class="n">kwdoc</span><span class="p">(</span><span class="n">Figure</span><span class="p">))</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, abir

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>